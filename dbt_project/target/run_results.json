{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0b2", "generated_at": "2025-07-11T07:45:18.609611Z", "invocation_id": "56a46a7b-b966-402e-af8a-2cbff489c332", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:13.276714Z", "completed_at": "2025-07-11T07:45:13.287670Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:13.288879Z", "completed_at": "2025-07-11T07:45:18.384763Z"}], "thread_id": "Thread-1", "execution_time": 5.11087703704834, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.artists_listened_to", "compiled": true, "compiled_code": "\n    SELECT\n        COUNT(DISTINCT artist_name) AS total_artists\n    FROM\n        raw_spotify_songs\n    WHERE\n        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)\n", "relation_name": "\"airflow\".\"public\".\"artists_listened_to\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.393133Z", "completed_at": "2025-07-11T07:45:18.396799Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.397035Z", "completed_at": "2025-07-11T07:45:18.415158Z"}], "thread_id": "Thread-1", "execution_time": 0.022812604904174805, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.minutes_per_artist", "compiled": true, "compiled_code": "\n    SELECT\n        artist_name,\n        SUM(duration_ms / (1000 * 60)) AS total_minutes_played\n    FROM\n        raw_spotify_songs\n    WHERE\n        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)\n    GROUP BY\n        artist_name\n    ORDER BY\n        total_minutes_played DESC\n", "relation_name": "\"airflow\".\"public\".\"minutes_per_artist\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.417175Z", "completed_at": "2025-07-11T07:45:18.419952Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.420123Z", "completed_at": "2025-07-11T07:45:18.435025Z"}], "thread_id": "Thread-1", "execution_time": 0.01848602294921875, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.most_streamed_artists", "compiled": true, "compiled_code": "\n    SELECT\n        artist_name,\n        COUNT(*) AS streams\n    FROM\n        raw_spotify_songs\n    WHERE\n        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)\n    GROUP BY\n        artist_name\n    ORDER BY\n        streams DESC\n", "relation_name": "\"airflow\".\"public\".\"most_streamed_artists\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.437035Z", "completed_at": "2025-07-11T07:45:18.439320Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.439502Z", "completed_at": "2025-07-11T07:45:18.455340Z"}], "thread_id": "Thread-1", "execution_time": 0.01894831657409668, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.most_streamed_songs", "compiled": true, "compiled_code": "\n    SELECT\n        track_name,\n        artist_name,\n        COUNT(*) AS streams\n    FROM\n        raw_spotify_songs\n    WHERE\n        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)\n    GROUP BY\n        track_name,\n        artist_name\n    ORDER BY\n        streams DESC\n", "relation_name": "\"airflow\".\"public\".\"most_streamed_songs\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.457511Z", "completed_at": "2025-07-11T07:45:18.459859Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.460065Z", "completed_at": "2025-07-11T07:45:18.476038Z"}], "thread_id": "Thread-1", "execution_time": 0.019195079803466797, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.newly_discovered_artists", "compiled": true, "compiled_code": "\n    WITH all_artists AS (\n        SELECT DISTINCT\n            artist_name\n        FROM\n            raw_spotify_songs\n        WHERE\n            played_at_ts >= cast('2025-07-11' as date)\n    ),\n    previous_artists AS (\n        SELECT DISTINCT\n            artist_name\n        FROM\n            raw_spotify_songs\n        WHERE\n            played_at_ts < cast('2025-07-11' as date)\n    )\n    SELECT\n        a.artist_name\n    FROM\n        all_artists a\n    LEFT JOIN\n        previous_artists p ON a.artist_name = p.artist_name\n    WHERE\n        p.artist_name IS NULL\n", "relation_name": "\"airflow\".\"public\".\"newly_discovered_artists\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.478014Z", "completed_at": "2025-07-11T07:45:18.519126Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.519351Z", "completed_at": "2025-07-11T07:45:18.539047Z"}], "thread_id": "Thread-1", "execution_time": 0.06166362762451172, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.newly_discovered_tracks", "compiled": true, "compiled_code": "\n    WITH all_tracks AS (\n        SELECT DISTINCT\n            track_name\n        FROM\n            raw_spotify_songs\n        WHERE\n            played_at_ts >= cast('2025-07-11' as date)\n    ),\n    previous_tracks AS (\n        SELECT DISTINCT\n            track_name\n        FROM\n            raw_spotify_songs\n        WHERE\n            played_at_ts < cast('2025-07-11' as date)\n    )\n    SELECT\n        a.track_name\n    FROM\n        all_tracks a\n    LEFT JOIN\n        previous_tracks p ON a.track_name = p.track_name\n    WHERE\n        p.track_name IS NULL\n", "relation_name": "\"airflow\".\"public\".\"newly_discovered_tracks\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.541060Z", "completed_at": "2025-07-11T07:45:18.543457Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.543632Z", "completed_at": "2025-07-11T07:45:18.559962Z"}], "thread_id": "Thread-1", "execution_time": 0.01951146125793457, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.total_minutes_streamed", "compiled": true, "compiled_code": "\n    SELECT\n        SUM(duration_ms / (60 * 1000)) AS total_minutes_streamed\n    FROM\n        raw_spotify_songs\n    WHERE\n        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)\n", "relation_name": "\"airflow\".\"public\".\"total_minutes_streamed\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.562780Z", "completed_at": "2025-07-11T07:45:18.565840Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.566268Z", "completed_at": "2025-07-11T07:45:18.582560Z"}], "thread_id": "Thread-1", "execution_time": 0.02099919319152832, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.tracks_listened_to", "compiled": true, "compiled_code": "\n    SELECT\n        COUNT(DISTINCT track_name) AS total_tracks\n    FROM\n        raw_spotify_songs\n    WHERE\n        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)\n", "relation_name": "\"airflow\".\"public\".\"tracks_listened_to\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-11T07:45:18.584956Z", "completed_at": "2025-07-11T07:45:18.588638Z"}, {"name": "execute", "started_at": "2025-07-11T07:45:18.588834Z", "completed_at": "2025-07-11T07:45:18.604529Z"}], "thread_id": "Thread-1", "execution_time": 0.020338058471679688, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.spotify_wrapped.tracks_per_dow", "compiled": true, "compiled_code": "\n    SELECT\n        EXTRACT(DOW FROM played_at_ts) AS day_of_week,\n        EXTRACT(HOUR FROM played_at_ts) AS hour,\n        SUM(duration_ms / (1000 * 60)) AS total_minutes\n    FROM\n        raw_spotify_songs\n    WHERE\n        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)\n    GROUP BY\n        1, 2\n", "relation_name": "\"airflow\".\"public\".\"tracks_per_dow\"", "batch_results": null}], "elapsed_time": 1641.5670237541199, "args": {"send_anonymous_usage_stats": true, "log_format_file": "debug", "log_level": "info", "write_json": true, "log_format": "default", "select": [], "log_level_file": "debug", "use_colors_file": true, "empty": false, "print": true, "indirect_selection": "eager", "vars": {"start_date": "2025-07-11", "end_date": "2025-07-11"}, "require_explicit_package_overrides_for_builtin_materializations": true, "source_freshness_run_project_hooks": false, "require_resource_names_without_spaces": false, "invocation_command": "dbt run --vars { \"start_date\": \"2025-07-11\", \"end_date\": \"2025-07-11\" }", "warn_error_options": {"include": [], "exclude": []}, "strict_mode": false, "introspect": true, "populate_cache": true, "use_colors": true, "which": "run", "state_modified_compare_more_unrendered_values": false, "log_file_max_bytes": 10485760, "log_path": "/opt/airflow/dbt_project/logs", "favor_state": false, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "project_dir": "/opt/airflow/dbt_project", "quiet": false, "state_modified_compare_vars": false, "profiles_dir": "/opt/airflow/dbt_project", "macro_debugging": false, "partial_parse": true, "cache_selected_only": false, "printer_width": 80, "partial_parse_file_diff": true, "exclude": [], "static_parser": true, "show_resource_report": false, "defer": false}}