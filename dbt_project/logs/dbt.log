[0m23:24:01.572977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f29c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904fc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eba4af0>]}


============================== 23:24:01.574846 | ca746622-da86-4524-bf25-848a90ad7d82 ==============================
[0m23:24:01.574846 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:24:01.575253 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:24:01.670726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca746622-da86-4524-bf25-848a90ad7d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902dd850>]}
[0m23:24:01.719264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca746622-da86-4524-bf25-848a90ad7d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e5896a0>]}
[0m23:24:01.720254 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:24:01.732547 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:24:01.733261 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:24:01.733586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca746622-da86-4524-bf25-848a90ad7d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7778e0>]}
[0m23:24:02.121788 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_wrapped
[0m23:24:02.124675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca746622-da86-4524-bf25-848a90ad7d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5ceeb0>]}
[0m23:24:02.171847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca746622-da86-4524-bf25-848a90ad7d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4d6d00>]}
[0m23:24:02.172340 [info ] [MainThread]: Found 423 macros
[0m23:24:02.172652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca746622-da86-4524-bf25-848a90ad7d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5c5ca0>]}
[0m23:24:02.173734 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:24:02.174132 [debug] [MainThread]: Command end result
[0m23:24:02.191735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6457292, "process_user_time": 1.041814, "process_kernel_time": 0.134005, "process_mem_max_rss": "91092", "process_in_blocks": "352", "process_out_blocks": "2381"}
[0m23:24:02.192581 [debug] [MainThread]: Command `dbt run` succeeded at 23:24:02.192463 after 0.65 seconds
[0m23:24:02.193144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f29c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d7779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f34f820>]}
[0m23:24:02.193612 [debug] [MainThread]: Flushing usage events
[0m23:24:02.689742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:08.692166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9cf1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabca6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabca6fd0>]}


============================== 23:26:08.694450 | 6a1c59f3-1a34-41a5-a172-79d22406150a ==============================
[0m23:26:08.694450 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:26:08.694869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:26:08.738804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f83160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1263970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1263520>]}


============================== 23:26:08.740803 | 58b34ec4-9816-4abc-9015-042e1b0482b9 ==============================
[0m23:26:08.740803 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:26:08.742235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:26:08.824477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a1c59f3-1a34-41a5-a172-79d22406150a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf5cf40>]}
[0m23:26:08.853436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a1c59f3-1a34-41a5-a172-79d22406150a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf7d670>]}
[0m23:26:08.854116 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:26:08.861577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58b34ec4-9816-4abc-9015-042e1b0482b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0588640>]}
[0m23:26:08.866112 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:26:08.893527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58b34ec4-9816-4abc-9015-042e1b0482b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa126c730>]}
[0m23:26:08.894078 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:26:08.901054 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:26:08.913905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:08.914209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:08.914511 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_wrapped
[0m23:26:08.917638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a1c59f3-1a34-41a5-a172-79d22406150a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac747f0>]}
[0m23:26:08.939539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:26:08.939834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:26:08.940110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_wrapped
[0m23:26:08.943370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58b34ec4-9816-4abc-9015-042e1b0482b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa025e700>]}
[0m23:26:08.973688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a1c59f3-1a34-41a5-a172-79d22406150a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabf06a0>]}
[0m23:26:08.973987 [info ] [MainThread]: Found 423 macros
[0m23:26:08.974426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a1c59f3-1a34-41a5-a172-79d22406150a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaac85640>]}
[0m23:26:08.975050 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:26:08.977651 [debug] [MainThread]: Command end result
[0m23:26:08.994534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58b34ec4-9816-4abc-9015-042e1b0482b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01d3610>]}
[0m23:26:08.995032 [info ] [MainThread]: Found 423 macros
[0m23:26:08.995761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58b34ec4-9816-4abc-9015-042e1b0482b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0269b20>]}
[0m23:26:08.996488 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:26:08.998332 [debug] [MainThread]: Command end result
[0m23:26:09.011193 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.36312014, "process_user_time": 1.098711, "process_kernel_time": 0.122755, "process_mem_max_rss": "89988", "process_out_blocks": "1561", "process_in_blocks": "0"}
[0m23:26:09.011901 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:09.011796 after 0.36 seconds
[0m23:26:09.012198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac9cf1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf7d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabf0eb0>]}
[0m23:26:09.012499 [debug] [MainThread]: Flushing usage events
[0m23:26:09.024531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.32885325, "process_user_time": 1.10144, "process_kernel_time": 0.13603, "process_mem_max_rss": "90052", "process_out_blocks": "1561", "process_in_blocks": "0"}
[0m23:26:09.024896 [debug] [MainThread]: Command `dbt run` succeeded at 23:26:09.024846 after 0.33 seconds
[0m23:26:09.025122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f83160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa126c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01d3e20>]}
[0m23:26:09.025299 [debug] [MainThread]: Flushing usage events
[0m23:26:09.433344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:26:09.433410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:51:37.713825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8c3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6b1d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db99fd0>]}


============================== 23:51:37.715806 | b0bc8bf2-a147-4856-8271-78c7e29a8954 ==============================
[0m23:51:37.715806 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:51:37.716197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:51:37.806370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0bc8bf2-a147-4856-8271-78c7e29a8954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6875e0>]}
[0m23:51:37.832206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0bc8bf2-a147-4856-8271-78c7e29a8954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbac7c0>]}
[0m23:51:37.832613 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:51:37.840209 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:51:37.873737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:51:37.874008 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:51:37.874245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_wrapped
[0m23:51:37.877306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0bc8bf2-a147-4856-8271-78c7e29a8954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb9b730>]}
[0m23:51:37.911049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0bc8bf2-a147-4856-8271-78c7e29a8954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb12640>]}
[0m23:51:37.911392 [info ] [MainThread]: Found 423 macros
[0m23:51:37.911575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0bc8bf2-a147-4856-8271-78c7e29a8954', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cba7a90>]}
[0m23:51:37.912160 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:51:37.913097 [debug] [MainThread]: Command end result
[0m23:51:37.927129 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.2385685, "process_user_time": 0.68581, "process_kernel_time": 0.165401, "process_mem_max_rss": "89980", "process_out_blocks": "1561", "process_in_blocks": "0"}
[0m23:51:37.927527 [debug] [MainThread]: Command `dbt run` succeeded at 23:51:37.927481 after 0.24 seconds
[0m23:51:37.927750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8c3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dbac7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb12e50>]}
[0m23:51:37.927949 [debug] [MainThread]: Flushing usage events
[0m23:51:38.347504 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:34.509930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6a30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8beaf160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfabb50>]}


============================== 23:58:34.511714 | 6e8de677-89a7-4f78-9f96-7a6229aa814f ==============================
[0m23:58:34.511714 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m23:58:34.512143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:58:34.592983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e8de677-89a7-4f78-9f96-7a6229aa814f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac5c7c0>]}
[0m23:58:34.617964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e8de677-89a7-4f78-9f96-7a6229aa814f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c464550>]}
[0m23:58:34.618363 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m23:58:34.625964 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m23:58:34.662371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:34.662630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:34.662866 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.spotify_wrapped
[0m23:58:34.665987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e8de677-89a7-4f78-9f96-7a6229aa814f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a983940>]}
[0m23:58:34.701052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e8de677-89a7-4f78-9f96-7a6229aa814f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9408b0>]}
[0m23:58:34.701371 [info ] [MainThread]: Found 423 macros
[0m23:58:34.701604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e8de677-89a7-4f78-9f96-7a6229aa814f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a990160>]}
[0m23:58:34.702480 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:58:34.703504 [debug] [MainThread]: Command end result
[0m23:58:34.717616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.23337112, "process_user_time": 0.712865, "process_kernel_time": 0.184482, "process_mem_max_rss": "90212", "process_in_blocks": "776", "process_out_blocks": "2217"}
[0m23:58:34.717940 [debug] [MainThread]: Command `dbt run` succeeded at 23:58:34.717888 after 0.23 seconds
[0m23:58:34.718157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6a30d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c464550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cbc95b0>]}
[0m23:58:34.718330 [debug] [MainThread]: Flushing usage events
[0m23:58:35.128909 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:01:29.520619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b24160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e06970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e06520>]}


============================== 00:01:29.522312 | b654133b-e234-498b-bae5-9b50d75ac3f9 ==============================
[0m00:01:29.522312 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:01:29.522662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:01:29.603511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b654133b-e234-498b-bae5-9b50d75ac3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e14f40>]}
[0m00:01:29.627934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b654133b-e234-498b-bae5-9b50d75ac3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e0e730>]}
[0m00:01:29.628317 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:01:29.635376 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:01:29.662679 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:01:29.663091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b654133b-e234-498b-bae5-9b50d75ac3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa230ea60>]}
[0m00:01:30.004393 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m00:01:30.009453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b654133b-e234-498b-bae5-9b50d75ac3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0eb9e20>]}
[0m00:01:30.091007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b654133b-e234-498b-bae5-9b50d75ac3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dd4160>]}
[0m00:01:30.091326 [info ] [MainThread]: Found 423 macros
[0m00:01:30.091684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b654133b-e234-498b-bae5-9b50d75ac3f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0dd42e0>]}
[0m00:01:30.092316 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:01:30.092652 [debug] [MainThread]: Command end result
[0m00:01:30.106709 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.61209065, "process_user_time": 1.050316, "process_kernel_time": 0.155788, "process_mem_max_rss": "90716", "process_out_blocks": "2349", "process_in_blocks": "0"}
[0m00:01:30.106987 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:30.106947 after 0.61 seconds
[0m00:01:30.107162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2b24160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2439b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0de6d30>]}
[0m00:01:30.107318 [debug] [MainThread]: Flushing usage events
[0m00:01:30.519526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:01:43.001357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9dd31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90aa9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90aad30>]}


============================== 00:01:43.002964 | 07570018-a9a2-4b88-a483-574135d34a00 ==============================
[0m00:01:43.002964 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:01:43.003265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:01:43.098270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07570018-a9a2-4b88-a483-574135d34a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ba3610>]}
[0m00:01:43.122942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07570018-a9a2-4b88-a483-574135d34a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa83d48e0>]}
[0m00:01:43.123398 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:01:43.131207 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:01:43.164857 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:01:43.165114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:01:43.165376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m00:01:43.168525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07570018-a9a2-4b88-a483-574135d34a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80a0820>]}
[0m00:01:43.200770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07570018-a9a2-4b88-a483-574135d34a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8016670>]}
[0m00:01:43.201062 [info ] [MainThread]: Found 423 macros
[0m00:01:43.201234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07570018-a9a2-4b88-a483-574135d34a00', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa80ab640>]}
[0m00:01:43.201805 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:01:43.202774 [debug] [MainThread]: Command end result
[0m00:01:43.217159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.24014296, "process_user_time": 0.682221, "process_kernel_time": 0.137641, "process_mem_max_rss": "90100", "process_out_blocks": "1561", "process_in_blocks": "0"}
[0m00:01:43.217492 [debug] [MainThread]: Command `dbt run` succeeded at 00:01:43.217446 after 0.24 seconds
[0m00:01:43.217697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9dd31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9ba3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8046550>]}
[0m00:01:43.217884 [debug] [MainThread]: Flushing usage events
[0m00:01:43.594879 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:05.970796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981b9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97490d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974907c0>]}


============================== 00:03:05.972748 | cf1f49de-1051-4a48-9b14-4f12f26697c5 ==============================
[0m00:03:05.972748 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:03:05.973205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:03:06.061538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf1f49de-1051-4a48-9b14-4f12f26697c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96772190>]}
[0m00:03:06.086248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf1f49de-1051-4a48-9b14-4f12f26697c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f556a0>]}
[0m00:03:06.086643 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:03:06.094153 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:03:06.119429 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:03:06.119782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cf1f49de-1051-4a48-9b14-4f12f26697c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979a5b20>]}
[0m00:03:06.469064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf1f49de-1051-4a48-9b14-4f12f26697c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff965a4ee0>]}
[0m00:03:06.523022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf1f49de-1051-4a48-9b14-4f12f26697c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964658b0>]}
[0m00:03:06.523334 [info ] [MainThread]: Found 423 macros
[0m00:03:06.523636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf1f49de-1051-4a48-9b14-4f12f26697c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96465a90>]}
[0m00:03:06.524247 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:03:06.524625 [debug] [MainThread]: Command end result
[0m00:03:06.538484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.59433055, "process_user_time": 1.045273, "process_kernel_time": 0.166724, "process_mem_max_rss": "90840", "process_out_blocks": "2348", "process_in_blocks": "0"}
[0m00:03:06.538799 [debug] [MainThread]: Command `dbt run` succeeded at 00:03:06.538753 after 0.59 seconds
[0m00:03:06.538997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff981b9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966bb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff964291c0>]}
[0m00:03:06.539160 [debug] [MainThread]: Flushing usage events
[0m00:03:06.947596 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:28.035242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd601c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0379d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad037d30>]}


============================== 00:11:28.037339 | 43a82f81-b7f4-43fb-b89b-a24de134fe38 ==============================
[0m00:11:28.037339 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:11:28.037900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:28.129357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad04a850>]}
[0m00:11:28.155504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac3458e0>]}
[0m00:11:28.156093 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:11:28.165151 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:11:28.206106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 18 files added, 0 files changed.
[0m00:11:28.206461 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/total_minutes_streamed.sql
[0m00:11:28.206662 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/most_streamed_songs.sql
[0m00:11:28.206815 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_most_streamed_artists.sql
[0m00:11:28.206952 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_tracks_per_dow.sql
[0m00:11:28.207081 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/tracks_listened_to.sql
[0m00:11:28.207256 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/minutes_per_artist.sql
[0m00:11:28.207459 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/most_streamed_artists.sql
[0m00:11:28.207623 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/tracks_per_dow.sql
[0m00:11:28.207765 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_total_minutes_streamed.sql
[0m00:11:28.207904 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/newly_discovered_artists.sql
[0m00:11:28.208041 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_most_streamed_songs.sql
[0m00:11:28.208176 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_tracks_listened_to.sql
[0m00:11:28.208309 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/artists_listened_to.sql
[0m00:11:28.208476 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_newly_discovered_tracks.sql
[0m00:11:28.208652 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_newly_discovered_artists.sql
[0m00:11:28.208805 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://models/newly_discovered_tracks.sql
[0m00:11:28.208943 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_minutes_per_artists.sql
[0m00:11:28.209083 [debug] [MainThread]: Partial parsing: added file: spotify_wrapped://macros/get_artists_listened_to.sql
[0m00:11:28.359725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe3d550>]}
[0m00:11:28.405842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe6cd90>]}
[0m00:11:28.406207 [info ] [MainThread]: Found 9 models, 432 macros
[0m00:11:28.406484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabe48730>]}
[0m00:11:28.407658 [info ] [MainThread]: 
[0m00:11:28.408108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:11:28.408367 [info ] [MainThread]: 
[0m00:11:28.408737 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:11:28.411390 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:11:28.437104 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:11:28.437430 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:11:28.437620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:33.472069 [debug] [ThreadPool]: SQL status: SELECT 4 in 5.032 seconds
[0m00:11:33.482208 [debug] [ThreadPool]: On list_airflow: Close
[0m00:11:33.495182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m00:11:33.506424 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:11:33.506882 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:11:33.507188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:33.512726 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m00:11:33.512966 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:11:33.513192 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:11:33.523196 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.010 seconds
[0m00:11:33.524976 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:11:33.525326 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:11:33.533442 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:33.533772 [debug] [MainThread]: On master: BEGIN
[0m00:11:33.533974 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:33.539394 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m00:11:33.539826 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:33.540123 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:11:33.548085 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m00:11:33.549385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabbe9fa0>]}
[0m00:11:33.550233 [debug] [MainThread]: On master: ROLLBACK
[0m00:11:33.550637 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:33.550803 [debug] [MainThread]: On master: BEGIN
[0m00:11:33.551132 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:11:33.551308 [debug] [MainThread]: On master: COMMIT
[0m00:11:33.551479 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:33.551628 [debug] [MainThread]: On master: COMMIT
[0m00:11:33.551812 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:33.551993 [debug] [MainThread]: On master: Close
[0m00:11:33.605325 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m00:11:33.639717 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m00:11:33.640987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m00:11:33.641519 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m00:11:33.679132 [debug] [Thread-1  ]: Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}
[0m00:11:33.689909 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab34bb50>]}
[0m00:11:33.690753 [error] [Thread-1  ]: 1 of 9 ERROR creating sql view model public.artists_listened_to ................ [[31mERROR[0m in 0.04s]
[0m00:11:33.691228 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m00:11:33.691583 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m00:11:33.692106 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.artists_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}.
[0m00:11:33.692422 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m00:11:33.693772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m00:11:33.694447 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m00:11:33.699956 [debug] [Thread-1  ]: Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}
[0m00:11:33.700396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2e54c0>]}
[0m00:11:33.701034 [error] [Thread-1  ]: 2 of 9 ERROR creating sql view model public.minutes_per_artist ................. [[31mERROR[0m in 0.01s]
[0m00:11:33.701472 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m00:11:33.701980 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m00:11:33.702374 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.minutes_per_artist' to be skipped because of status 'error'.  Reason: Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}.
[0m00:11:33.703693 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m00:11:33.706869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m00:11:33.707357 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m00:11:33.710870 [debug] [Thread-1  ]: Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}
[0m00:11:33.711185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2fc550>]}
[0m00:11:33.711599 [error] [Thread-1  ]: 3 of 9 ERROR creating sql view model public.most_streamed_artists .............. [[31mERROR[0m in 0.01s]
[0m00:11:33.712008 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m00:11:33.712288 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m00:11:33.712621 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_artists' to be skipped because of status 'error'.  Reason: Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}.
[0m00:11:33.712908 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m00:11:33.713533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m00:11:33.713764 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m00:11:33.716962 [debug] [Thread-1  ]: Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}
[0m00:11:33.717376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2ff370>]}
[0m00:11:33.717867 [error] [Thread-1  ]: 4 of 9 ERROR creating sql view model public.most_streamed_songs ................ [[31mERROR[0m in 0.00s]
[0m00:11:33.718352 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m00:11:33.718670 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m00:11:33.718899 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_songs' to be skipped because of status 'error'.  Reason: Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}.
[0m00:11:33.719174 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m00:11:33.719838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m00:11:33.720062 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m00:11:33.723861 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}
[0m00:11:33.724230 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab28de20>]}
[0m00:11:33.724628 [error] [Thread-1  ]: 5 of 9 ERROR creating sql view model public.newly_discovered_artists ........... [[31mERROR[0m in 0.00s]
[0m00:11:33.725040 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m00:11:33.728734 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m00:11:33.728944 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_artists' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}.
[0m00:11:33.729190 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m00:11:33.729634 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m00:11:33.729833 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m00:11:33.732008 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}
[0m00:11:33.732231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2bb7c0>]}
[0m00:11:33.732609 [error] [Thread-1  ]: 6 of 9 ERROR creating sql view model public.newly_discovered_tracks ............ [[31mERROR[0m in 0.00s]
[0m00:11:33.733008 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m00:11:33.733246 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m00:11:33.733462 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_tracks' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}.
[0m00:11:33.733698 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m00:11:33.734161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m00:11:33.734376 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m00:11:33.822004 [debug] [Thread-1  ]: Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}
[0m00:11:33.822554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabffb820>]}
[0m00:11:33.822981 [error] [Thread-1  ]: 7 of 9 ERROR creating sql view model public.total_minutes_streamed ............. [[31mERROR[0m in 0.09s]
[0m00:11:33.823463 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m00:11:33.823879 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m00:11:33.824112 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.total_minutes_streamed' to be skipped because of status 'error'.  Reason: Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}.
[0m00:11:33.824399 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m00:11:33.824894 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m00:11:33.825101 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m00:11:33.827829 [debug] [Thread-1  ]: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}
[0m00:11:33.828120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabfbd310>]}
[0m00:11:33.828523 [error] [Thread-1  ]: 8 of 9 ERROR creating sql view model public.tracks_listened_to ................. [[31mERROR[0m in 0.00s]
[0m00:11:33.828908 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m00:11:33.829170 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m00:11:33.829402 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}.
[0m00:11:33.829654 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m00:11:33.830274 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m00:11:33.830550 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m00:11:33.833024 [debug] [Thread-1  ]: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}
[0m00:11:33.833283 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43a82f81-b7f4-43fb-b89b-a24de134fe38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac17e070>]}
[0m00:11:33.833639 [error] [Thread-1  ]: 9 of 9 ERROR creating sql view model public.tracks_per_dow ..................... [[31mERROR[0m in 0.00s]
[0m00:11:33.833914 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m00:11:33.834229 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_per_dow' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}.
[0m00:11:33.835086 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:33.835278 [debug] [MainThread]: On master: BEGIN
[0m00:11:33.835428 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:33.839048 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m00:11:33.839408 [debug] [MainThread]: On master: COMMIT
[0m00:11:33.839570 [debug] [MainThread]: Using postgres connection "master"
[0m00:11:33.839715 [debug] [MainThread]: On master: COMMIT
[0m00:11:33.839910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:11:33.840059 [debug] [MainThread]: On master: Close
[0m00:11:33.840336 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:33.840513 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m00:11:33.840803 [info ] [MainThread]: 
[0m00:11:33.841246 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m00:11:33.842037 [debug] [MainThread]: Command end result
[0m00:11:33.864058 [info ] [MainThread]: 
[0m00:11:33.864730 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successs, and 0 warnings:[0m
[0m00:11:33.865066 [info ] [MainThread]: 
[0m00:11:33.866116 [error] [MainThread]:   Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}
[0m00:11:33.866431 [info ] [MainThread]: 
[0m00:11:33.866698 [error] [MainThread]:   Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}
[0m00:11:33.867023 [info ] [MainThread]: 
[0m00:11:33.867302 [error] [MainThread]:   Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}
[0m00:11:33.867538 [info ] [MainThread]: 
[0m00:11:33.867885 [error] [MainThread]:   Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}
[0m00:11:33.868126 [info ] [MainThread]: 
[0m00:11:33.868436 [error] [MainThread]:   Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}
[0m00:11:33.868669 [info ] [MainThread]: 
[0m00:11:33.868937 [error] [MainThread]:   Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}
[0m00:11:33.869233 [info ] [MainThread]: 
[0m00:11:33.869788 [error] [MainThread]:   Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}
[0m00:11:33.870060 [info ] [MainThread]: 
[0m00:11:33.870397 [error] [MainThread]:   Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}
[0m00:11:33.870679 [info ] [MainThread]: 
[0m00:11:33.870992 [error] [MainThread]:   Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}
[0m00:11:33.871224 [info ] [MainThread]: 
[0m00:11:33.871503 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
[0m00:11:33.872655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8670177, "process_user_time": 1.218773, "process_kernel_time": 0.277088, "process_mem_max_rss": "101164", "process_out_blocks": "2578", "command_success": false, "process_in_blocks": "0"}
[0m00:11:33.873339 [debug] [MainThread]: Command `dbt run` failed at 00:11:33.873279 after 5.87 seconds
[0m00:11:33.874041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd601c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb5b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2b2f70>]}
[0m00:11:33.874299 [debug] [MainThread]: Flushing usage events
[0m00:11:34.380611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:51.042913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996361c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989119d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98911d30>]}


============================== 00:12:51.044496 | 9b993f14-b980-4f42-8e0a-df2135c0b0ed ==============================
[0m00:12:51.044496 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:12:51.044845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-04", "end_date": "2025-07-11" }', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:51.138924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98920850>]}
[0m00:12:51.176132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c498e0>]}
[0m00:12:51.176641 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:12:51.183271 [debug] [MainThread]: checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-04'}, profile: , target: , version: 1.9.0b2
[0m00:12:51.221143 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:12:51.221510 [debug] [MainThread]: previous checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f, current checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f
[0m00:12:51.221782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98e20c70>]}
[0m00:12:51.719079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977789d0>]}
[0m00:12:51.759637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97bc7d90>]}
[0m00:12:51.759947 [info ] [MainThread]: Found 9 models, 432 macros
[0m00:12:51.760156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97757eb0>]}
[0m00:12:51.761098 [info ] [MainThread]: 
[0m00:12:51.761352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:12:51.761527 [info ] [MainThread]: 
[0m00:12:51.761863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:12:51.764275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:12:51.781329 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:12:51.781541 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:12:51.781690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:51.784166 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m00:12:51.784723 [debug] [ThreadPool]: On list_airflow: Close
[0m00:12:51.785626 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m00:12:51.788532 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:12:51.788720 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:12:51.788879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:51.790191 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m00:12:51.790377 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:12:51.790534 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:12:51.792417 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.002 seconds
[0m00:12:51.793283 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:12:51.793480 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:12:51.798169 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.798335 [debug] [MainThread]: On master: BEGIN
[0m00:12:51.798477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:12:51.799867 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m00:12:51.800014 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.800179 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:12:51.803845 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m00:12:51.804465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977d5610>]}
[0m00:12:51.804712 [debug] [MainThread]: On master: ROLLBACK
[0m00:12:51.804937 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.805088 [debug] [MainThread]: On master: BEGIN
[0m00:12:51.805339 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:12:51.805498 [debug] [MainThread]: On master: COMMIT
[0m00:12:51.805624 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:51.805748 [debug] [MainThread]: On master: COMMIT
[0m00:12:51.805974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:12:51.806134 [debug] [MainThread]: On master: Close
[0m00:12:51.807556 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m00:12:51.807832 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m00:12:51.808086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m00:12:51.808323 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m00:12:51.812579 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m00:12:51.816432 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m00:12:51.832957 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m00:12:51.833903 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m00:12:51.834070 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m00:12:51.834211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.850222 [debug] [Thread-1  ]: SQL status: BEGIN in 5.015 seconds
[0m00:12:56.851721 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m00:12:56.852484 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    



SELECT COUNT(DISTINCT artist_id)
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'


  );
[0m00:12:56.855618 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 12: FROM raw_spotify_songs
              ^

[0m00:12:56.856461 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: ROLLBACK
[0m00:12:56.857550 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m00:12:56.864953 [debug] [Thread-1  ]: Database Error in model artists_listened_to (models/artists_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql
[0m00:12:56.867005 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f1ddc0>]}
[0m00:12:56.867797 [error] [Thread-1  ]: 1 of 9 ERROR creating sql view model public.artists_listened_to ................ [[31mERROR[0m in 5.06s]
[0m00:12:56.868582 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m00:12:56.869197 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m00:12:56.869808 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.artists_listened_to' to be skipped because of status 'error'.  Reason: Database Error in model artists_listened_to (models/artists_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql.
[0m00:12:56.870354 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m00:12:56.871250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m00:12:56.871596 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m00:12:56.875513 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m00:12:56.876751 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m00:12:56.880193 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m00:12:56.880994 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m00:12:56.881258 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m00:12:56.881488 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.883720 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:12:56.883967 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m00:12:56.884199 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    



SELECT 
    a.artist_name,
    SUM(t.song_duration_ms / (60*1000)) as minutes
FROM raw_spotify_songs AS t
JOIN artists AS a
USING (artist_id)
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'
GROUP BY a.artist_name
ORDER BY minutes DESC


  );
[0m00:12:56.884631 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 14: FROM raw_spotify_songs AS t
              ^

[0m00:12:56.884870 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: ROLLBACK
[0m00:12:56.885184 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m00:12:56.886772 [debug] [Thread-1  ]: Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "raw_spotify_songs" does not exist
  LINE 14: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql
[0m00:12:56.887060 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99486c70>]}
[0m00:12:56.887487 [error] [Thread-1  ]: 2 of 9 ERROR creating sql view model public.minutes_per_artist ................. [[31mERROR[0m in 0.02s]
[0m00:12:56.887886 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m00:12:56.888224 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m00:12:56.888700 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.minutes_per_artist' to be skipped because of status 'error'.  Reason: Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "raw_spotify_songs" does not exist
  LINE 14: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql.
[0m00:12:56.889149 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m00:12:56.889626 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m00:12:56.889909 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m00:12:56.892026 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m00:12:56.892673 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m00:12:56.895291 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m00:12:56.895831 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m00:12:56.896038 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m00:12:56.896222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.897985 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:12:56.898197 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m00:12:56.898394 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    



SELECT 
   t.artist_id,
   a.artist_name,
   COUNT(t.artist_id) AS streams

FROM raw_spotify_songs AS t
join artists AS a
USING (artist_id)
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'
GROUP BY a.artist_name, t.artist_id
ORDER BY streams  DESC


  );
[0m00:12:56.898757 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 16: FROM raw_spotify_songs AS t
              ^

[0m00:12:56.898990 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: ROLLBACK
[0m00:12:56.899317 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m00:12:56.899893 [debug] [Thread-1  ]: Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 16: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql
[0m00:12:56.900149 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e61400>]}
[0m00:12:56.900501 [error] [Thread-1  ]: 3 of 9 ERROR creating sql view model public.most_streamed_artists .............. [[31mERROR[0m in 0.01s]
[0m00:12:56.900873 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m00:12:56.901087 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m00:12:56.901528 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m00:12:56.901800 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m00:12:56.902059 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m00:12:56.901309 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_artists' to be skipped because of status 'error'.  Reason: Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 16: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql.
[0m00:12:56.904023 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m00:12:56.904942 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m00:12:56.907322 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m00:12:56.907909 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m00:12:56.908144 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m00:12:56.908318 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.915851 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m00:12:56.916120 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m00:12:56.916434 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    



SELECT 
    track_id,
    track_name,
    COUNT(track_id) as streams
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04' and '2025-07-11'
GROUP BY track_id, track_name
ORDER BY streams DESC


  );
[0m00:12:56.917413 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 15: FROM raw_spotify_songs
              ^

[0m00:12:56.917993 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: ROLLBACK
[0m00:12:56.918621 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m00:12:56.919419 [debug] [Thread-1  ]: Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  relation "raw_spotify_songs" does not exist
  LINE 15: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql
[0m00:12:56.919798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fc5fa0>]}
[0m00:12:56.920462 [error] [Thread-1  ]: 4 of 9 ERROR creating sql view model public.most_streamed_songs ................ [[31mERROR[0m in 0.02s]
[0m00:12:56.921058 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m00:12:56.921555 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m00:12:56.922118 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m00:12:56.922472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m00:12:56.922706 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m00:12:56.921895 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_songs' to be skipped because of status 'error'.  Reason: Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  relation "raw_spotify_songs" does not exist
  LINE 15: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql.
[0m00:12:56.925023 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m00:12:56.925748 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m00:12:56.928050 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m00:12:56.928541 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m00:12:56.928724 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m00:12:56.928877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.930809 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:12:56.930980 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m00:12:56.931139 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    




SELECT a.artist_name
FROM raw_spotify_songs AS t
JOIN artists AS a
USING(artist_id)
WHERE played_at >= '2025-07-04'
  AND artist_id NOT IN (
    SELECT artist_id
    FROM raw_spotify_songs
    WHERE played_at < '2025-07-04'
  )


  );
[0m00:12:56.931456 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 13: FROM raw_spotify_songs AS t
              ^

[0m00:12:56.931630 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: ROLLBACK
[0m00:12:56.931876 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m00:12:56.932342 [debug] [Thread-1  ]: Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql
[0m00:12:56.932554 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ff6160>]}
[0m00:12:56.932842 [error] [Thread-1  ]: 5 of 9 ERROR creating sql view model public.newly_discovered_artists ........... [[31mERROR[0m in 0.01s]
[0m00:12:56.933144 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m00:12:56.933329 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m00:12:56.933737 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m00:12:56.934003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m00:12:56.934180 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m00:12:56.933531 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_artists' to be skipped because of status 'error'.  Reason: Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql.
[0m00:12:56.936555 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_tracks"
[0m00:12:56.937210 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_tracks
[0m00:12:56.939351 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_tracks"
[0m00:12:56.939801 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m00:12:56.939975 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: BEGIN
[0m00:12:56.940127 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.942571 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:12:56.942740 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m00:12:56.942900 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */

  create view "airflow"."public"."newly_discovered_tracks__dbt_tmp"
    
    
  as (
    




SELECT DISTINCT(track_name)
FROM raw_spotify_songs
WHERE played_at >= '2025-07-04'
  AND track_id NOT IN (
    SELECT track_id
    FROM raw_spotify_songs
    WHERE played_at < '2025-07-04'
  )


  );
[0m00:12:56.943278 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 13: FROM raw_spotify_songs
              ^

[0m00:12:56.943442 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: ROLLBACK
[0m00:12:56.943668 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: Close
[0m00:12:56.944173 [debug] [Thread-1  ]: Database Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_tracks.sql
[0m00:12:56.944393 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ff6130>]}
[0m00:12:56.944700 [error] [Thread-1  ]: 6 of 9 ERROR creating sql view model public.newly_discovered_tracks ............ [[31mERROR[0m in 0.01s]
[0m00:12:56.945034 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m00:12:56.945231 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m00:12:56.945628 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m00:12:56.945883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m00:12:56.946054 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m00:12:56.945436 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_tracks' to be skipped because of status 'error'.  Reason: Database Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_tracks.sql.
[0m00:12:56.947751 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m00:12:56.948381 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m00:12:56.950659 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m00:12:56.951143 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m00:12:56.951304 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m00:12:56.951435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.955186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m00:12:56.955424 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m00:12:56.955674 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    




SELECT SUM(song_duration_ms / (60 * 1000)) AS total_minutes_streamed
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'


  );
[0m00:12:56.956262 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 13: FROM raw_spotify_songs
              ^

[0m00:12:56.956568 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: ROLLBACK
[0m00:12:56.957020 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m00:12:56.957698 [debug] [Thread-1  ]: Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql
[0m00:12:56.957986 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e65610>]}
[0m00:12:56.958354 [error] [Thread-1  ]: 7 of 9 ERROR creating sql view model public.total_minutes_streamed ............. [[31mERROR[0m in 0.01s]
[0m00:12:56.958735 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m00:12:56.958964 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m00:12:56.959583 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m00:12:56.959887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m00:12:56.960080 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m00:12:56.959311 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.total_minutes_streamed' to be skipped because of status 'error'.  Reason: Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql.
[0m00:12:56.961936 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_listened_to"
[0m00:12:56.962521 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_listened_to
[0m00:12:56.964544 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_listened_to"
[0m00:12:56.964985 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m00:12:56.965154 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: BEGIN
[0m00:12:56.965314 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.967199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:12:56.967435 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m00:12:56.967641 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */

  create view "airflow"."public"."tracks_listened_to__dbt_tmp"
    
    
  as (
    



SELECT COUNT(DISTINCT track_id)
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'


  );
[0m00:12:56.968032 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 12: FROM raw_spotify_songs
              ^

[0m00:12:56.968255 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: ROLLBACK
[0m00:12:56.968497 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: Close
[0m00:12:56.969282 [debug] [Thread-1  ]: Database Error in model tracks_listened_to (models/tracks_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/tracks_listened_to.sql
[0m00:12:56.969688 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96bedca0>]}
[0m00:12:56.970354 [error] [Thread-1  ]: 8 of 9 ERROR creating sql view model public.tracks_listened_to ................. [[31mERROR[0m in 0.01s]
[0m00:12:56.970765 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m00:12:56.971106 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m00:12:56.972022 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m00:12:56.972481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m00:12:56.972734 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m00:12:56.971607 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_listened_to' to be skipped because of status 'error'.  Reason: Database Error in model tracks_listened_to (models/tracks_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/tracks_listened_to.sql.
[0m00:12:56.975478 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_per_dow"
[0m00:12:56.976490 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_per_dow
[0m00:12:56.979666 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_per_dow"
[0m00:12:56.980251 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m00:12:56.980418 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: BEGIN
[0m00:12:56.980572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:12:56.982606 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:12:56.982805 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m00:12:56.982977 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */

  create view "airflow"."public"."tracks_per_dow__dbt_tmp"
    
    
  as (
    



SELECT EXTRACT(DOW FROM played_at) AS day_of_week, 
    EXTRACT(HOUR FROM played_at) AS hour,
    SUM(SONG_duration_ms / (60 * 100)) AS total_minutes
from public.raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'
GROUP BY day_of_week, hour
ORDER BY total_minutes DESC


  );
[0m00:12:56.983313 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.raw_spotify_songs" does not exist
LINE 14: from public.raw_spotify_songs
              ^

[0m00:12:56.983507 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: ROLLBACK
[0m00:12:56.983743 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: Close
[0m00:12:56.984280 [debug] [Thread-1  ]: Database Error in model tracks_per_dow (models/tracks_per_dow.sql)
  relation "public.raw_spotify_songs" does not exist
  LINE 14: from public.raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/tracks_per_dow.sql
[0m00:12:56.984541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b993f14-b980-4f42-8e0a-df2135c0b0ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96bd4190>]}
[0m00:12:56.984889 [error] [Thread-1  ]: 9 of 9 ERROR creating sql view model public.tracks_per_dow ..................... [[31mERROR[0m in 0.01s]
[0m00:12:56.985201 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m00:12:56.985444 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_per_dow' to be skipped because of status 'error'.  Reason: Database Error in model tracks_per_dow (models/tracks_per_dow.sql)
  relation "public.raw_spotify_songs" does not exist
  LINE 14: from public.raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/tracks_per_dow.sql.
[0m00:12:56.986191 [debug] [MainThread]: Using postgres connection "master"
[0m00:12:56.986384 [debug] [MainThread]: On master: BEGIN
[0m00:12:56.986551 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:13:02.002578 [debug] [MainThread]: SQL status: BEGIN in 5.015 seconds
[0m00:13:02.005078 [debug] [MainThread]: On master: COMMIT
[0m00:13:02.005984 [debug] [MainThread]: Using postgres connection "master"
[0m00:13:02.006787 [debug] [MainThread]: On master: COMMIT
[0m00:13:02.007658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:13:02.008581 [debug] [MainThread]: On master: Close
[0m00:13:02.010856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:13:02.011536 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m00:13:02.012074 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m00:13:02.013839 [info ] [MainThread]: 
[0m00:13:02.014667 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m00:13:02.018275 [debug] [MainThread]: Command end result
[0m00:13:02.058937 [info ] [MainThread]: 
[0m00:13:02.059608 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successs, and 0 warnings:[0m
[0m00:13:02.059979 [info ] [MainThread]: 
[0m00:13:02.060416 [error] [MainThread]:   Database Error in model artists_listened_to (models/artists_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql
[0m00:13:02.060662 [info ] [MainThread]: 
[0m00:13:02.060945 [error] [MainThread]:   Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "raw_spotify_songs" does not exist
  LINE 14: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql
[0m00:13:02.061153 [info ] [MainThread]: 
[0m00:13:02.061428 [error] [MainThread]:   Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 16: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql
[0m00:13:02.061662 [info ] [MainThread]: 
[0m00:13:02.061942 [error] [MainThread]:   Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  relation "raw_spotify_songs" does not exist
  LINE 15: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql
[0m00:13:02.062178 [info ] [MainThread]: 
[0m00:13:02.062456 [error] [MainThread]:   Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql
[0m00:13:02.062650 [info ] [MainThread]: 
[0m00:13:02.062907 [error] [MainThread]:   Database Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_tracks.sql
[0m00:13:02.063114 [info ] [MainThread]: 
[0m00:13:02.063368 [error] [MainThread]:   Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql
[0m00:13:02.063558 [info ] [MainThread]: 
[0m00:13:02.063809 [error] [MainThread]:   Database Error in model tracks_listened_to (models/tracks_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/tracks_listened_to.sql
[0m00:13:02.063966 [info ] [MainThread]: 
[0m00:13:02.064246 [error] [MainThread]:   Database Error in model tracks_per_dow (models/tracks_per_dow.sql)
  relation "public.raw_spotify_songs" does not exist
  LINE 14: from public.raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/tracks_per_dow.sql
[0m00:13:02.064470 [info ] [MainThread]: 
[0m00:13:02.064698 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
[0m00:13:02.066624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 11.050939, "process_user_time": 1.363999, "process_kernel_time": 0.154452, "process_mem_max_rss": "101396", "process_in_blocks": "56", "process_out_blocks": "2631", "command_success": false}
[0m00:13:02.067175 [debug] [MainThread]: Command `dbt run` failed at 00:13:02.067108 after 11.05 seconds
[0m00:13:02.067618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996361c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c498e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a4e880>]}
[0m00:13:02.067967 [debug] [MainThread]: Flushing usage events
[0m00:13:02.598092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:18:11.976834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f27100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cdd310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81735070>]}


============================== 00:18:11.978476 | 40405e11-121c-4f60-a454-af9d600d71ee ==============================
[0m00:18:11.978476 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:18:11.978827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-04", "end_date": "2025-07-11" }', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:18:12.061516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804c08e0>]}
[0m00:18:12.085497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81211580>]}
[0m00:18:12.085889 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:18:12.095271 [debug] [MainThread]: checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-04'}, profile: , target: , version: 1.9.0b2
[0m00:18:12.143822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m00:18:12.144145 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_per_dow.sql
[0m00:18:12.144351 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/newly_discovered_tracks.sql
[0m00:18:12.144526 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_listened_to.sql
[0m00:18:12.251792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801ab970>]}
[0m00:18:12.294405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd50190>]}
[0m00:18:12.294727 [info ] [MainThread]: Found 9 models, 432 macros
[0m00:18:12.294939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80040d00>]}
[0m00:18:12.295838 [info ] [MainThread]: 
[0m00:18:12.296044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:18:12.296287 [info ] [MainThread]: 
[0m00:18:12.296667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:18:12.299005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:18:12.315901 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:18:12.316155 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:18:12.316385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:12.321310 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m00:18:12.322056 [debug] [ThreadPool]: On list_airflow: Close
[0m00:18:12.323178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m00:18:12.326530 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:18:12.326749 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:18:12.326912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:18:17.337804 [debug] [ThreadPool]: SQL status: BEGIN in 5.011 seconds
[0m00:18:17.339677 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:18:17.340116 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:18:17.346276 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.005 seconds
[0m00:18:17.350198 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:18:17.350998 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:18:17.362546 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:17.362885 [debug] [MainThread]: On master: BEGIN
[0m00:18:17.363156 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:18:22.384767 [debug] [MainThread]: SQL status: BEGIN in 5.020 seconds
[0m00:18:22.387633 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:22.388561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:18:22.395800 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m00:18:22.400093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd50460>]}
[0m00:18:22.401963 [debug] [MainThread]: On master: ROLLBACK
[0m00:18:22.402484 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:22.402797 [debug] [MainThread]: On master: BEGIN
[0m00:18:22.403359 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:18:22.403768 [debug] [MainThread]: On master: COMMIT
[0m00:18:22.404095 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:22.404392 [debug] [MainThread]: On master: COMMIT
[0m00:18:22.404871 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:22.405357 [debug] [MainThread]: On master: Close
[0m00:18:22.411642 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m00:18:22.412793 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m00:18:22.413564 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m00:18:22.414002 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m00:18:22.423278 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m00:18:22.424694 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m00:18:22.446187 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m00:18:22.447143 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m00:18:22.447372 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m00:18:22.447593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:18:22.449456 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:18:22.449632 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m00:18:22.449798 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    



SELECT COUNT(DISTINCT artist_id)
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'


  );
[0m00:18:22.450292 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 12: FROM raw_spotify_songs
              ^

[0m00:18:22.450480 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: ROLLBACK
[0m00:18:22.450771 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m00:18:22.453076 [debug] [Thread-1  ]: Database Error in model artists_listened_to (models/artists_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql
[0m00:18:22.457384 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f528910>]}
[0m00:18:22.457784 [error] [Thread-1  ]: 1 of 9 ERROR creating sql view model public.artists_listened_to ................ [[31mERROR[0m in 0.04s]
[0m00:18:22.458230 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m00:18:22.458666 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m00:18:22.459153 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.artists_listened_to' to be skipped because of status 'error'.  Reason: Database Error in model artists_listened_to (models/artists_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql.
[0m00:18:22.459599 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m00:18:22.460355 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m00:18:22.460631 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m00:18:22.464442 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m00:18:22.465270 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m00:18:22.468351 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m00:18:22.469160 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m00:18:22.469447 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m00:18:22.469732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:18:27.488050 [debug] [Thread-1  ]: SQL status: BEGIN in 5.018 seconds
[0m00:18:27.489730 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m00:18:27.490545 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    



SELECT 
    a.artist_name,
    SUM(t.song_duration_ms / (60*1000)) as minutes
FROM raw_spotify_songs AS t
JOIN artists AS a
USING (artist_id)
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'
GROUP BY a.artist_name
ORDER BY minutes DESC


  );
[0m00:18:27.493267 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 14: FROM raw_spotify_songs AS t
              ^

[0m00:18:27.494001 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: ROLLBACK
[0m00:18:27.495449 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m00:18:27.497757 [debug] [Thread-1  ]: Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "raw_spotify_songs" does not exist
  LINE 14: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql
[0m00:18:27.498960 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81fff550>]}
[0m00:18:27.500388 [error] [Thread-1  ]: 2 of 9 ERROR creating sql view model public.minutes_per_artist ................. [[31mERROR[0m in 5.04s]
[0m00:18:27.501211 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m00:18:27.501837 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m00:18:27.502459 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.minutes_per_artist' to be skipped because of status 'error'.  Reason: Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "raw_spotify_songs" does not exist
  LINE 14: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql.
[0m00:18:27.503077 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m00:18:27.504147 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m00:18:27.504645 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m00:18:27.509693 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m00:18:27.511597 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m00:18:27.515270 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m00:18:27.516054 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m00:18:27.516340 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m00:18:27.516617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:18:27.519129 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:18:27.519404 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m00:18:27.519654 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    



SELECT 
   t.artist_id,
   a.artist_name,
   COUNT(t.artist_id) AS streams

FROM raw_spotify_songs AS t
join artists AS a
USING (artist_id)
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'
GROUP BY a.artist_name, t.artist_id
ORDER BY streams  DESC


  );
[0m00:18:27.520129 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 16: FROM raw_spotify_songs AS t
              ^

[0m00:18:27.520401 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: ROLLBACK
[0m00:18:27.520737 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m00:18:27.521425 [debug] [Thread-1  ]: Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 16: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql
[0m00:18:27.521712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f52eb20>]}
[0m00:18:27.522146 [error] [Thread-1  ]: 3 of 9 ERROR creating sql view model public.most_streamed_artists .............. [[31mERROR[0m in 0.02s]
[0m00:18:27.522723 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m00:18:27.523156 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m00:18:27.523849 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m00:18:27.523523 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_artists' to be skipped because of status 'error'.  Reason: Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 16: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql.
[0m00:18:27.524229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m00:18:27.524578 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m00:18:27.527494 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m00:18:27.528131 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m00:18:27.530833 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m00:18:27.531358 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m00:18:27.531575 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m00:18:27.531763 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:18:27.533521 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:18:27.533732 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m00:18:27.533926 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    



SELECT 
    track_id,
    track_name,
    COUNT(track_id) as streams
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04' and '2025-07-11'
GROUP BY track_id, track_name
ORDER BY streams DESC


  );
[0m00:18:27.534308 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 15: FROM raw_spotify_songs
              ^

[0m00:18:27.534509 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: ROLLBACK
[0m00:18:27.534778 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m00:18:27.535309 [debug] [Thread-1  ]: Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  relation "raw_spotify_songs" does not exist
  LINE 15: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql
[0m00:18:27.535566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f52eb20>]}
[0m00:18:27.535904 [error] [Thread-1  ]: 4 of 9 ERROR creating sql view model public.most_streamed_songs ................ [[31mERROR[0m in 0.01s]
[0m00:18:27.536244 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m00:18:27.536501 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m00:18:27.536991 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m00:18:27.537292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m00:18:27.537519 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m00:18:27.536758 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_songs' to be skipped because of status 'error'.  Reason: Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  relation "raw_spotify_songs" does not exist
  LINE 15: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql.
[0m00:18:27.540232 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m00:18:27.541091 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m00:18:27.543543 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m00:18:27.544026 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m00:18:27.544217 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m00:18:27.544394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:18:27.546957 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m00:18:27.547137 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m00:18:27.547308 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    




SELECT a.artist_name
FROM raw_spotify_songs AS t
JOIN artists AS a
USING(artist_id)
WHERE played_at >= '2025-07-04'
  AND artist_id NOT IN (
    SELECT artist_id
    FROM raw_spotify_songs
    WHERE played_at < '2025-07-04'
  )


  );
[0m00:18:27.547738 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 13: FROM raw_spotify_songs AS t
              ^

[0m00:18:27.547933 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: ROLLBACK
[0m00:18:27.548183 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m00:18:27.548741 [debug] [Thread-1  ]: Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql
[0m00:18:27.548973 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f52eb20>]}
[0m00:18:27.549328 [error] [Thread-1  ]: 5 of 9 ERROR creating sql view model public.newly_discovered_artists ........... [[31mERROR[0m in 0.01s]
[0m00:18:27.549758 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m00:18:27.549963 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m00:18:27.550433 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m00:18:27.550731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m00:18:27.551010 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m00:18:27.550195 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_artists' to be skipped because of status 'error'.  Reason: Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql.
[0m00:18:27.555337 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  'get_newly_discovered_raw_spotify_songs' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:18:27.555600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1e9040>]}
[0m00:18:27.555892 [error] [Thread-1  ]: 6 of 9 ERROR creating sql view model public.newly_discovered_tracks ............ [[31mERROR[0m in 0.00s]
[0m00:18:27.556189 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m00:18:27.556407 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m00:18:27.556812 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m00:18:27.557069 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m00:18:27.557276 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m00:18:27.556583 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_tracks' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  'get_newly_discovered_raw_spotify_songs' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:18:27.634254 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m00:18:27.635863 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m00:18:27.637930 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m00:18:27.638426 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m00:18:27.638605 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m00:18:27.638758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:18:27.641176 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:18:27.641385 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m00:18:27.641556 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    




SELECT SUM(song_duration_ms / (60 * 1000)) AS total_minutes_streamed
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'


  );
[0m00:18:27.641875 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "raw_spotify_songs" does not exist
LINE 13: FROM raw_spotify_songs
              ^

[0m00:18:27.642047 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: ROLLBACK
[0m00:18:27.642311 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m00:18:27.642805 [debug] [Thread-1  ]: Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql
[0m00:18:27.643051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1ff790>]}
[0m00:18:27.643426 [error] [Thread-1  ]: 7 of 9 ERROR creating sql view model public.total_minutes_streamed ............. [[31mERROR[0m in 0.09s]
[0m00:18:27.643809 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m00:18:27.644042 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m00:18:27.644216 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.total_minutes_streamed' to be skipped because of status 'error'.  Reason: Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql.
[0m00:18:27.644424 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m00:18:27.644783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m00:18:27.644973 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m00:18:27.646839 [debug] [Thread-1  ]: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  'get_raw_spotify_songs_listened_to' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:18:27.647074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1d6100>]}
[0m00:18:27.647484 [error] [Thread-1  ]: 8 of 9 ERROR creating sql view model public.tracks_listened_to ................. [[31mERROR[0m in 0.00s]
[0m00:18:27.647754 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m00:18:27.647947 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m00:18:27.648279 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m00:18:27.648524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m00:18:27.648729 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m00:18:27.648114 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  'get_raw_spotify_songs_listened_to' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:18:27.650389 [debug] [Thread-1  ]: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  'get_raw_spotify_songs_per_dow' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:18:27.650648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40405e11-121c-4f60-a454-af9d600d71ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f870e50>]}
[0m00:18:27.650893 [error] [Thread-1  ]: 9 of 9 ERROR creating sql view model public.tracks_per_dow ..................... [[31mERROR[0m in 0.00s]
[0m00:18:27.651152 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m00:18:27.651370 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_per_dow' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  'get_raw_spotify_songs_per_dow' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:18:27.651977 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:27.652126 [debug] [MainThread]: On master: BEGIN
[0m00:18:27.652258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:18:27.653813 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:18:27.653998 [debug] [MainThread]: On master: COMMIT
[0m00:18:27.654137 [debug] [MainThread]: Using postgres connection "master"
[0m00:18:27.654269 [debug] [MainThread]: On master: COMMIT
[0m00:18:27.654501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:18:27.654655 [debug] [MainThread]: On master: Close
[0m00:18:27.654843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:18:27.654987 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m00:18:27.655137 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m00:18:27.655336 [info ] [MainThread]: 
[0m00:18:27.655538 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 15.36 seconds (15.36s).
[0m00:18:27.656310 [debug] [MainThread]: Command end result
[0m00:18:27.673618 [info ] [MainThread]: 
[0m00:18:27.673869 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successs, and 0 warnings:[0m
[0m00:18:27.674081 [info ] [MainThread]: 
[0m00:18:27.674307 [error] [MainThread]:   Database Error in model artists_listened_to (models/artists_listened_to.sql)
  relation "raw_spotify_songs" does not exist
  LINE 12: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql
[0m00:18:27.674572 [info ] [MainThread]: 
[0m00:18:27.674806 [error] [MainThread]:   Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "raw_spotify_songs" does not exist
  LINE 14: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql
[0m00:18:27.674978 [info ] [MainThread]: 
[0m00:18:27.675215 [error] [MainThread]:   Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 16: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql
[0m00:18:27.675427 [info ] [MainThread]: 
[0m00:18:27.675644 [error] [MainThread]:   Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  relation "raw_spotify_songs" does not exist
  LINE 15: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql
[0m00:18:27.675801 [info ] [MainThread]: 
[0m00:18:27.676014 [error] [MainThread]:   Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs AS t
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql
[0m00:18:27.676203 [info ] [MainThread]: 
[0m00:18:27.676441 [error] [MainThread]:   Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  'get_newly_discovered_raw_spotify_songs' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:18:27.676590 [info ] [MainThread]: 
[0m00:18:27.676810 [error] [MainThread]:   Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  relation "raw_spotify_songs" does not exist
  LINE 13: FROM raw_spotify_songs
                ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql
[0m00:18:27.677002 [info ] [MainThread]: 
[0m00:18:27.677208 [error] [MainThread]:   Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  'get_raw_spotify_songs_listened_to' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:18:27.677397 [info ] [MainThread]: 
[0m00:18:27.677616 [error] [MainThread]:   Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  'get_raw_spotify_songs_per_dow' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:18:27.677788 [info ] [MainThread]: 
[0m00:18:27.678022 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
[0m00:18:27.678913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.726954, "process_user_time": 1.051727, "process_kernel_time": 0.187129, "process_mem_max_rss": "101568", "process_out_blocks": "2615", "command_success": false, "process_in_blocks": "0"}
[0m00:18:27.679209 [debug] [MainThread]: Command `dbt run` failed at 00:18:27.679163 after 15.73 seconds
[0m00:18:27.679421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f27100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80523fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80523e80>]}
[0m00:18:27.679603 [debug] [MainThread]: Flushing usage events
[0m00:18:28.205851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:26:20.155422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa819a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f5a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7aaedc0>]}


============================== 00:26:20.156749 | cfdbf258-be03-42b8-9318-9a8d47b9ff4c ==============================
[0m00:26:20.156749 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:26:20.157045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-04", "end_date": "2025-07-11" }', 'send_anonymous_usage_stats': 'True'}
[0m00:26:20.230219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91db8e0>]}
[0m00:26:20.253427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa679e7c0>]}
[0m00:26:20.253797 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:26:20.260114 [debug] [MainThread]: checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-04'}, profile: , target: , version: 1.9.0b2
[0m00:26:20.306371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
[0m00:26:20.306726 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_artists.sql
[0m00:26:20.306947 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_listened_to.sql
[0m00:26:20.307154 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_artists.sql
[0m00:26:20.307347 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_artists_listened_to.sql
[0m00:26:20.307537 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_total_minutes_streamed.sql
[0m00:26:20.307729 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_songs.sql
[0m00:26:20.307891 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_tracks.sql
[0m00:26:20.308062 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_per_dow.sql
[0m00:26:20.308247 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_minutes_per_artists.sql
[0m00:26:20.424706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa62583d0>]}
[0m00:26:20.465092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa679eaf0>]}
[0m00:26:20.465448 [info ] [MainThread]: Found 9 models, 432 macros
[0m00:26:20.466085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa63c0730>]}
[0m00:26:20.467309 [info ] [MainThread]: 
[0m00:26:20.467521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:26:20.467782 [info ] [MainThread]: 
[0m00:26:20.468140 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:26:20.470703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:26:20.487934 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:26:20.488171 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:26:20.488324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:25.506486 [debug] [ThreadPool]: SQL status: SELECT 4 in 5.018 seconds
[0m00:26:25.510237 [debug] [ThreadPool]: On list_airflow: Close
[0m00:26:25.515497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m00:26:25.523071 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:26:25.523571 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m00:26:25.523998 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:25.527106 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m00:26:25.527533 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m00:26:25.527920 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m00:26:25.532630 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.004 seconds
[0m00:26:25.534448 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m00:26:25.534836 [debug] [ThreadPool]: On list_airflow_public: Close
[0m00:26:25.543036 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:25.543412 [debug] [MainThread]: On master: BEGIN
[0m00:26:25.543648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:25.545821 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m00:26:25.546037 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:25.546299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m00:26:25.549060 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m00:26:25.549794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6287850>]}
[0m00:26:25.550168 [debug] [MainThread]: On master: ROLLBACK
[0m00:26:25.550445 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:25.550634 [debug] [MainThread]: On master: BEGIN
[0m00:26:25.550944 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m00:26:25.551130 [debug] [MainThread]: On master: COMMIT
[0m00:26:25.551319 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:25.551498 [debug] [MainThread]: On master: COMMIT
[0m00:26:25.551760 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:26:25.551951 [debug] [MainThread]: On master: Close
[0m00:26:25.553931 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m00:26:25.554300 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m00:26:25.554685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m00:26:25.555013 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m00:26:25.560947 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m00:26:25.561760 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m00:26:25.580442 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m00:26:25.581078 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m00:26:25.581289 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m00:26:25.581497 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:25.583142 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:26:25.583331 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m00:26:25.583527 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    



SELECT COUNT(DISTINCT artist_id)
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'


  );
[0m00:26:25.584545 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "played_at" does not exist
LINE 13: WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'
               ^
HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".

[0m00:26:25.584730 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: ROLLBACK
[0m00:26:25.584975 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m00:26:25.586140 [debug] [Thread-1  ]: Database Error in model artists_listened_to (models/artists_listened_to.sql)
  column "played_at" does not exist
  LINE 13: WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'
                 ^
  HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql
[0m00:26:25.587002 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5aa87c0>]}
[0m00:26:25.587332 [error] [Thread-1  ]: 1 of 9 ERROR creating sql view model public.artists_listened_to ................ [[31mERROR[0m in 0.03s]
[0m00:26:25.587705 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m00:26:25.587923 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m00:26:25.588175 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.artists_listened_to' to be skipped because of status 'error'.  Reason: Database Error in model artists_listened_to (models/artists_listened_to.sql)
  column "played_at" does not exist
  LINE 13: WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'
                 ^
  HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql.
[0m00:26:25.588428 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m00:26:25.588878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m00:26:25.589076 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m00:26:25.590898 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m00:26:25.591387 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m00:26:25.593643 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m00:26:25.594350 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m00:26:25.594545 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m00:26:25.594718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:25.596818 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:26:25.597005 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m00:26:25.597170 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    



SELECT 
    a.artist_name,
    SUM(t.song_duration_ms / (60*1000)) as minutes
FROM raw_spotify_songs AS t
JOIN artists AS a
USING (artist_id)
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'
GROUP BY a.artist_name
ORDER BY minutes DESC


  );
[0m00:26:25.597717 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "artists" does not exist
LINE 15: JOIN artists AS a
              ^

[0m00:26:25.597905 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: ROLLBACK
[0m00:26:25.598204 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m00:26:25.598820 [debug] [Thread-1  ]: Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "artists" does not exist
  LINE 15: JOIN artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql
[0m00:26:25.599170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5aa87c0>]}
[0m00:26:25.599653 [error] [Thread-1  ]: 2 of 9 ERROR creating sql view model public.minutes_per_artist ................. [[31mERROR[0m in 0.01s]
[0m00:26:25.600010 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m00:26:25.600253 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m00:26:25.600703 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m00:26:25.601040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m00:26:25.601227 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m00:26:25.600475 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.minutes_per_artist' to be skipped because of status 'error'.  Reason: Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "artists" does not exist
  LINE 15: JOIN artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql.
[0m00:26:25.603736 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m00:26:25.604762 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m00:26:25.607501 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m00:26:25.608688 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m00:26:25.608941 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m00:26:25.609123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:25.611024 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:26:25.611198 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m00:26:25.611360 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    



SELECT 
   t.artist_id,
   a.artist_name,
   COUNT(t.artist_id) AS streams

FROM raw_spotify_songs AS t
join artists AS a
USING (artist_id)
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'
GROUP BY a.artist_name, t.artist_id
ORDER BY streams  DESC


  );
[0m00:26:25.611741 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "artists" does not exist
LINE 17: join artists AS a
              ^

[0m00:26:25.611936 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: ROLLBACK
[0m00:26:25.612204 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m00:26:25.612849 [debug] [Thread-1  ]: Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "artists" does not exist
  LINE 17: join artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql
[0m00:26:25.613104 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a538b0>]}
[0m00:26:25.613475 [error] [Thread-1  ]: 3 of 9 ERROR creating sql view model public.most_streamed_artists .............. [[31mERROR[0m in 0.01s]
[0m00:26:25.613834 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m00:26:25.614044 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m00:26:25.614457 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m00:26:25.614720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m00:26:25.614892 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m00:26:25.614257 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_artists' to be skipped because of status 'error'.  Reason: Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "artists" does not exist
  LINE 17: join artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql.
[0m00:26:25.617219 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m00:26:25.617919 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m00:26:25.652698 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m00:26:25.653522 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m00:26:25.653730 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m00:26:25.653907 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:25.655942 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:26:25.656113 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m00:26:25.656277 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    



SELECT 
    track_id,
    track_name,
    COUNT(track_id) as streams
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04' and '2025-07-11'
GROUP BY track_id, track_name
ORDER BY streams DESC


  );
[0m00:26:25.656711 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "played_at" does not exist
LINE 16: WHERE played_at BETWEEN '2025-07-04' and '2025-07-11'
               ^
HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".

[0m00:26:25.656881 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: ROLLBACK
[0m00:26:25.657107 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m00:26:25.657647 [debug] [Thread-1  ]: Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  column "played_at" does not exist
  LINE 16: WHERE played_at BETWEEN '2025-07-04' and '2025-07-11'
                 ^
  HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql
[0m00:26:25.657940 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa635e6d0>]}
[0m00:26:25.658282 [error] [Thread-1  ]: 4 of 9 ERROR creating sql view model public.most_streamed_songs ................ [[31mERROR[0m in 0.04s]
[0m00:26:25.658652 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m00:26:25.658853 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m00:26:25.659243 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m00:26:25.659501 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m00:26:25.659692 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m00:26:25.659056 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_songs' to be skipped because of status 'error'.  Reason: Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  column "played_at" does not exist
  LINE 16: WHERE played_at BETWEEN '2025-07-04' and '2025-07-11'
                 ^
  HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql.
[0m00:26:25.661340 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m00:26:25.661859 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m00:26:25.663777 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m00:26:25.664189 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m00:26:25.664362 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m00:26:25.664533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:30.671904 [debug] [Thread-1  ]: SQL status: BEGIN in 5.007 seconds
[0m00:26:30.673032 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m00:26:30.673407 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    




SELECT a.artist_name
FROM raw_spotify_songs AS t
JOIN artists AS a
USING(artist_id)
WHERE played_at >= '2025-07-04'
  AND artist_id NOT IN (
    SELECT artist_id
    FROM raw_spotify_songs
    WHERE played_at < '2025-07-04'
  )


  );
[0m00:26:30.674166 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "artists" does not exist
LINE 14: JOIN artists AS a
              ^

[0m00:26:30.674492 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: ROLLBACK
[0m00:26:30.675119 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m00:26:30.676689 [debug] [Thread-1  ]: Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "artists" does not exist
  LINE 14: JOIN artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql
[0m00:26:30.677472 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66e5e50>]}
[0m00:26:30.678413 [error] [Thread-1  ]: 5 of 9 ERROR creating sql view model public.newly_discovered_artists ........... [[31mERROR[0m in 5.02s]
[0m00:26:30.679119 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m00:26:30.679465 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m00:26:30.680082 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m00:26:30.680458 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m00:26:30.680743 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m00:26:30.679814 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_artists' to be skipped because of status 'error'.  Reason: Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "artists" does not exist
  LINE 14: JOIN artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql.
[0m00:26:30.685774 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  'get_newly_discovered_raw_spotify_songs' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:26:30.686255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79a09a0>]}
[0m00:26:30.686605 [error] [Thread-1  ]: 6 of 9 ERROR creating sql view model public.newly_discovered_tracks ............ [[31mERROR[0m in 0.01s]
[0m00:26:30.686975 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m00:26:30.687228 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m00:26:30.687732 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m00:26:30.688065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m00:26:30.688281 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m00:26:30.687475 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_tracks' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  'get_newly_discovered_raw_spotify_songs' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:26:30.690242 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m00:26:30.690999 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m00:26:30.693748 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m00:26:30.694275 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m00:26:30.694471 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m00:26:30.694657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:26:30.696446 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m00:26:30.696627 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m00:26:30.696835 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    




SELECT SUM(song_duration_ms / (60 * 1000)) AS total_minutes_streamed
FROM raw_spotify_songs
WHERE played_at BETWEEN '2025-07-04' AND '2025-07-11'


  );
[0m00:26:30.697243 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "song_duration_ms" does not exist
LINE 12: SELECT SUM(song_duration_ms / (60 * 1000)) AS total_minutes_...
                    ^

[0m00:26:30.697427 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: ROLLBACK
[0m00:26:30.697679 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m00:26:30.698213 [debug] [Thread-1  ]: Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  column "song_duration_ms" does not exist
  LINE 12: SELECT SUM(song_duration_ms / (60 * 1000)) AS total_minutes_...
                      ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql
[0m00:26:30.698440 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa65d0850>]}
[0m00:26:30.698801 [error] [Thread-1  ]: 7 of 9 ERROR creating sql view model public.total_minutes_streamed ............. [[31mERROR[0m in 0.01s]
[0m00:26:30.699149 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m00:26:30.699355 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m00:26:30.699850 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m00:26:30.700122 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m00:26:30.700312 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m00:26:30.699577 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.total_minutes_streamed' to be skipped because of status 'error'.  Reason: Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  column "song_duration_ms" does not exist
  LINE 12: SELECT SUM(song_duration_ms / (60 * 1000)) AS total_minutes_...
                      ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql.
[0m00:26:30.703795 [debug] [Thread-1  ]: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  'get_raw_spotify_songs_listened_to' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:26:30.704195 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa57d6ee0>]}
[0m00:26:30.704491 [error] [Thread-1  ]: 8 of 9 ERROR creating sql view model public.tracks_listened_to ................. [[31mERROR[0m in 0.00s]
[0m00:26:30.704816 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m00:26:30.705014 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m00:26:30.705392 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m00:26:30.705651 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m00:26:30.705839 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m00:26:30.705202 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  'get_raw_spotify_songs_listened_to' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:26:30.707770 [debug] [Thread-1  ]: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  'get_raw_spotify_songs_per_dow' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:26:30.708033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfdbf258-be03-42b8-9318-9a8d47b9ff4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa679ea30>]}
[0m00:26:30.708303 [error] [Thread-1  ]: 9 of 9 ERROR creating sql view model public.tracks_per_dow ..................... [[31mERROR[0m in 0.00s]
[0m00:26:30.708590 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m00:26:30.708822 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_per_dow' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  'get_raw_spotify_songs_per_dow' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m00:26:30.709555 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:30.709750 [debug] [MainThread]: On master: BEGIN
[0m00:26:30.709903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:26:35.727763 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m00:26:35.729541 [debug] [MainThread]: On master: COMMIT
[0m00:26:35.730417 [debug] [MainThread]: Using postgres connection "master"
[0m00:26:35.731069 [debug] [MainThread]: On master: COMMIT
[0m00:26:35.731979 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m00:26:35.732699 [debug] [MainThread]: On master: Close
[0m00:26:35.734226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:35.734856 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m00:26:35.736055 [info ] [MainThread]: 
[0m00:26:35.737268 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 15.27 seconds (15.27s).
[0m00:26:35.740026 [debug] [MainThread]: Command end result
[0m00:26:35.781786 [info ] [MainThread]: 
[0m00:26:35.782193 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successs, and 0 warnings:[0m
[0m00:26:35.782524 [info ] [MainThread]: 
[0m00:26:35.782825 [error] [MainThread]:   Database Error in model artists_listened_to (models/artists_listened_to.sql)
  column "played_at" does not exist
  LINE 13: WHERE played_at BETWEEN '2025-07-04'  AND '2025-07-11'
                 ^
  HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".
  compiled code at target/run/spotify_wrapped/models/artists_listened_to.sql
[0m00:26:35.783090 [info ] [MainThread]: 
[0m00:26:35.783415 [error] [MainThread]:   Database Error in model minutes_per_artist (models/minutes_per_artist.sql)
  relation "artists" does not exist
  LINE 15: JOIN artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/minutes_per_artist.sql
[0m00:26:35.783613 [info ] [MainThread]: 
[0m00:26:35.783877 [error] [MainThread]:   Database Error in model most_streamed_artists (models/most_streamed_artists.sql)
  relation "artists" does not exist
  LINE 17: join artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/most_streamed_artists.sql
[0m00:26:35.784079 [info ] [MainThread]: 
[0m00:26:35.784337 [error] [MainThread]:   Database Error in model most_streamed_songs (models/most_streamed_songs.sql)
  column "played_at" does not exist
  LINE 16: WHERE played_at BETWEEN '2025-07-04' and '2025-07-11'
                 ^
  HINT:  Perhaps you meant to reference the column "raw_spotify_songs.played_at_ts" or the column "raw_spotify_songs.played_at_ms".
  compiled code at target/run/spotify_wrapped/models/most_streamed_songs.sql
[0m00:26:35.784580 [info ] [MainThread]: 
[0m00:26:35.784901 [error] [MainThread]:   Database Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  relation "artists" does not exist
  LINE 14: JOIN artists AS a
                ^
  compiled code at target/run/spotify_wrapped/models/newly_discovered_artists.sql
[0m00:26:35.785159 [info ] [MainThread]: 
[0m00:26:35.785404 [error] [MainThread]:   Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  'get_newly_discovered_raw_spotify_songs' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:26:35.785620 [info ] [MainThread]: 
[0m00:26:35.785884 [error] [MainThread]:   Database Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  column "song_duration_ms" does not exist
  LINE 12: SELECT SUM(song_duration_ms / (60 * 1000)) AS total_minutes_...
                      ^
  compiled code at target/run/spotify_wrapped/models/total_minutes_streamed.sql
[0m00:26:35.786111 [info ] [MainThread]: 
[0m00:26:35.786373 [error] [MainThread]:   Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  'get_raw_spotify_songs_listened_to' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:26:35.786594 [info ] [MainThread]: 
[0m00:26:35.786847 [error] [MainThread]:   Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  'get_raw_spotify_songs_per_dow' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m00:26:35.787062 [info ] [MainThread]: 
[0m00:26:35.787312 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
[0m00:26:35.788813 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 15.656093, "process_user_time": 0.980909, "process_kernel_time": 0.104776, "process_mem_max_rss": "101488", "process_out_blocks": "2621", "command_success": false, "process_in_blocks": "0"}
[0m00:26:35.789333 [debug] [MainThread]: Command `dbt run` failed at 00:26:35.789276 after 15.66 seconds
[0m00:26:35.789677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa819a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7fb43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6234220>]}
[0m00:26:35.789907 [debug] [MainThread]: Flushing usage events
[0m00:26:36.540854 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:42:58.088258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d082250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c367fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3607c0>]}


============================== 00:42:58.089871 | 1550119d-bb63-4507-94cd-9ef9aea64299 ==============================
[0m00:42:58.089871 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:42:58.090175 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-04", "end_date": "2025-07-11" }', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:42:58.166318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1550119d-bb63-4507-94cd-9ef9aea64299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e0bb9d0>]}
[0m00:42:58.190163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1550119d-bb63-4507-94cd-9ef9aea64299', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdde6d0>]}
[0m00:42:58.190554 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:42:58.197219 [debug] [MainThread]: checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-04'}, profile: , target: , version: 1.9.0b2
[0m00:42:58.248952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 15 files changed.
[0m00:42:58.249302 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_artists.sql
[0m00:42:58.249530 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_songs.sql
[0m00:42:58.249793 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_total_minutes_streamed.sql
[0m00:42:58.250033 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/artists_listened_to.sql
[0m00:42:58.250218 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_listened_to.sql
[0m00:42:58.250395 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_listened_to.sql
[0m00:42:58.250548 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/most_streamed_songs.sql
[0m00:42:58.250727 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/most_streamed_artists.sql
[0m00:42:58.250904 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/minutes_per_artist.sql
[0m00:42:58.251102 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_tracks.sql
[0m00:42:58.251277 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_minutes_per_artists.sql
[0m00:42:58.251453 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_per_dow.sql
[0m00:42:58.251669 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_per_dow.sql
[0m00:42:58.251862 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_artists.sql
[0m00:42:58.252049 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_artists_listened_to.sql
[0m00:42:58.333541 [error] [MainThread]: Encountered an error:
Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  macro 'dbt_macro__get_newly_discovered_artists' takes no keyword argument 'start_date'
[0m00:42:58.334249 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.27056545, "process_user_time": 0.709785, "process_kernel_time": 0.089224, "process_mem_max_rss": "92724", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:42:58.334582 [debug] [MainThread]: Command `dbt run` failed at 00:42:58.334516 after 0.27 seconds
[0m00:42:58.334814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d082250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b67e700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b24dca0>]}
[0m00:42:58.335055 [debug] [MainThread]: Flushing usage events
[0m00:42:58.752434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:47.462670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bbd51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aeb1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aeb1fd0>]}


============================== 00:47:47.464375 | a5c5c071-a38b-4d12-b1d1-99b2bce17676 ==============================
[0m00:47:47.464375 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:47:47.464777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-04", "end_date": "2025-07-11" }', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:47:47.545621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c5c071-a38b-4d12-b1d1-99b2bce17676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aec98e0>]}
[0m00:47:47.569212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5c5c071-a38b-4d12-b1d1-99b2bce17676', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a167760>]}
[0m00:47:47.569589 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:47:47.576417 [debug] [MainThread]: checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-04'}, profile: , target: , version: 1.9.0b2
[0m00:47:47.631935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 16 files changed.
[0m00:47:47.632284 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/most_streamed_artists.sql
[0m00:47:47.632508 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_per_dow.sql
[0m00:47:47.632735 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_minutes_per_artists.sql
[0m00:47:47.632942 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_per_dow.sql
[0m00:47:47.633152 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_songs.sql
[0m00:47:47.633309 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/most_streamed_songs.sql
[0m00:47:47.633475 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_listened_to.sql
[0m00:47:47.633644 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_listened_to.sql
[0m00:47:47.633808 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_artists.sql
[0m00:47:47.634059 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_total_minutes_streamed.sql
[0m00:47:47.634299 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_artists_listened_to.sql
[0m00:47:47.634495 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_artists.sql
[0m00:47:47.634638 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/artists_listened_to.sql
[0m00:47:47.634797 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/newly_discovered_tracks.sql
[0m00:47:47.634978 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_tracks.sql
[0m00:47:47.635190 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/minutes_per_artist.sql
[0m00:47:47.725229 [error] [MainThread]: Encountered an error:
Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  macro 'dbt_macro__get_tracks_per_dow' takes no keyword argument 'start_date'
[0m00:47:47.725975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29034483, "process_user_time": 0.775332, "process_kernel_time": 0.138017, "process_mem_max_rss": "92592", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m00:47:47.726325 [debug] [MainThread]: Command `dbt run` failed at 00:47:47.726268 after 0.29 seconds
[0m00:47:47.726557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bbd51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b3e45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cb17f0>]}
[0m00:47:47.726794 [debug] [MainThread]: Flushing usage events
[0m00:47:48.171356 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:53:49.605616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9a71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc809d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc80d30>]}


============================== 00:53:49.607267 | c924af70-4bd3-46ba-968d-7fe7c14c7f42 ==============================
[0m00:53:49.607267 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:53:49.607580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:49.685213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c924af70-4bd3-46ba-968d-7fe7c14c7f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc92850>]}
[0m00:53:49.708629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c924af70-4bd3-46ba-968d-7fe7c14c7f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfa68e0>]}
[0m00:53:49.709031 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:53:49.715641 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:53:49.752575 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:53:49.752873 [debug] [MainThread]: previous checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, current checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f
[0m00:53:49.753098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c924af70-4bd3-46ba-968d-7fe7c14c7f42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e18fc70>]}
[0m00:53:50.133801 [error] [MainThread]: Encountered an error:
Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  macro 'dbt_macro__get_tracks_per_dow' takes no keyword argument 'start_date'
[0m00:53:50.134453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.55259943, "process_user_time": 0.96776, "process_kernel_time": 0.09478, "process_mem_max_rss": "92300", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m00:53:50.134782 [debug] [MainThread]: Command `dbt run` failed at 00:53:50.134730 after 0.55 seconds
[0m00:53:50.135021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9a71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf966a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cb24610>]}
[0m00:53:50.135248 [debug] [MainThread]: Flushing usage events
[0m00:53:50.540521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:57.447863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9744d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97244d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96725fd0>]}


============================== 00:54:57.449456 | 35c22ad6-acf9-42df-bbc1-b265f7c3d9e2 ==============================
[0m00:54:57.449456 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m00:54:57.449863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:54:57.530631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35c22ad6-acf9-42df-bbc1-b265f7c3d9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959fa4c0>]}
[0m00:54:57.553731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35c22ad6-acf9-42df-bbc1-b265f7c3d9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9673d7c0>]}
[0m00:54:57.554133 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m00:54:57.561026 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m00:54:57.597406 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:54:57.597689 [debug] [MainThread]: previous checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, current checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f
[0m00:54:57.597920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '35c22ad6-acf9-42df-bbc1-b265f7c3d9e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c3aa90>]}
[0m00:54:57.986377 [error] [MainThread]: Encountered an error:
Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  macro 'dbt_macro__get_tracks_per_dow' takes no keyword argument 'start_date'
[0m00:54:57.986992 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.56309503, "process_user_time": 0.97345, "process_kernel_time": 0.110164, "process_mem_max_rss": "92300", "process_out_blocks": "5", "command_success": false, "process_in_blocks": "0"}
[0m00:54:57.987317 [debug] [MainThread]: Command `dbt run` failed at 00:54:57.987268 after 0.56 seconds
[0m00:54:57.987536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9744d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a5e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955ee610>]}
[0m00:54:57.987740 [debug] [MainThread]: Flushing usage events
[0m00:54:58.369574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:10:20.950446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f231c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb61fc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb61fcd30>]}


============================== 01:10:20.952119 | 165c072f-584c-4ebb-982d-079ebb8bf96b ==============================
[0m01:10:20.952119 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:10:20.952552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-04", "end_date": "2025-07-11" }', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:10:21.033814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb620e850>]}
[0m01:10:21.057912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb552e8e0>]}
[0m01:10:21.058357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:10:21.065849 [debug] [MainThread]: checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-04'}, profile: , target: , version: 1.9.0b2
[0m01:10:21.116919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 18 files changed.
[0m01:10:21.117294 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_artists_listened_to.sql
[0m01:10:21.117501 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/total_minutes_streamed.sql
[0m01:10:21.117684 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/newly_discovered_tracks.sql
[0m01:10:21.117854 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_listened_to.sql
[0m01:10:21.118013 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_per_dow.sql
[0m01:10:21.118169 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/most_streamed_artists.sql
[0m01:10:21.118327 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_tracks_listened_to.sql
[0m01:10:21.118529 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_songs.sql
[0m01:10:21.118685 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/most_streamed_songs.sql
[0m01:10:21.118874 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_minutes_per_artists.sql
[0m01:10:21.119041 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_most_streamed_artists.sql
[0m01:10:21.119199 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_tracks.sql
[0m01:10:21.119383 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_newly_discovered_artists.sql
[0m01:10:21.119554 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://macros/get_total_minutes_streamed.sql
[0m01:10:21.119697 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/minutes_per_artist.sql
[0m01:10:21.119841 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/newly_discovered_artists.sql
[0m01:10:21.120004 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/tracks_per_dow.sql
[0m01:10:21.120144 [debug] [MainThread]: Partial parsing: updated file: spotify_wrapped://models/artists_listened_to.sql
[0m01:10:21.243674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4dfda60>]}
[0m01:10:21.287409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d13df0>]}
[0m01:10:21.287777 [info ] [MainThread]: Found 9 models, 432 macros
[0m01:10:21.288000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb528f790>]}
[0m01:10:21.288989 [info ] [MainThread]: 
[0m01:10:21.289224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:10:21.289457 [info ] [MainThread]: 
[0m01:10:21.289850 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:10:21.292316 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:10:21.308444 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:10:21.308663 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:10:21.308836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:10:26.332725 [debug] [ThreadPool]: SQL status: SELECT 4 in 5.023 seconds
[0m01:10:26.341449 [debug] [ThreadPool]: On list_airflow: Close
[0m01:10:26.347793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m01:10:26.363164 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:10:26.363620 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m01:10:26.363997 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:10:26.367490 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m01:10:26.367835 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:10:26.368104 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:10:26.372661 [debug] [ThreadPool]: SQL status: SELECT 43 in 0.004 seconds
[0m01:10:26.374014 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m01:10:26.374308 [debug] [ThreadPool]: On list_airflow_public: Close
[0m01:10:26.380848 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:26.381062 [debug] [MainThread]: On master: BEGIN
[0m01:10:26.381255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:10:26.383246 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:10:26.383475 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:26.383747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:10:26.386398 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m01:10:26.387156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d442b0>]}
[0m01:10:26.387740 [debug] [MainThread]: On master: ROLLBACK
[0m01:10:26.387986 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:26.388163 [debug] [MainThread]: On master: BEGIN
[0m01:10:26.388456 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:10:26.388632 [debug] [MainThread]: On master: COMMIT
[0m01:10:26.388829 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:26.388999 [debug] [MainThread]: On master: COMMIT
[0m01:10:26.389227 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:10:26.389423 [debug] [MainThread]: On master: Close
[0m01:10:26.391945 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m01:10:26.392360 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m01:10:26.392763 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m01:10:26.393059 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m01:10:26.398308 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m01:10:26.399629 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m01:10:26.417759 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m01:10:26.418840 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:10:26.419031 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m01:10:26.419211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:26.421104 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:10:26.421316 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:10:26.421506 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT artist_name) AS total_artists
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-04' as date) AND cast('2025-07-11' as date)

  );
[0m01:10:26.428672 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m01:10:26.432243 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:10:26.432679 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to__dbt_tmp" rename to "artists_listened_to"
[0m01:10:26.434194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:10:26.444558 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m01:10:26.444819 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:10:26.445039 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m01:10:26.447165 [debug] [Thread-1  ]: SQL status: COMMIT in 0.002 seconds
[0m01:10:26.514231 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."artists_listened_to__dbt_backup"
[0m01:10:26.516477 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:10:26.516732 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
drop view if exists "airflow"."public"."artists_listened_to__dbt_backup" cascade
[0m01:10:26.517460 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:26.518826 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m01:10:26.519739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb451c490>]}
[0m01:10:26.520190 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.artists_listened_to .................... [[32mCREATE VIEW[0m in 0.13s]
[0m01:10:26.520520 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m01:10:26.520721 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m01:10:26.520975 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m01:10:26.521195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m01:10:26.521359 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m01:10:26.523069 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m01:10:26.523667 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m01:10:26.525638 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m01:10:26.526261 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:10:26.526436 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m01:10:26.526604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.540959 [debug] [Thread-1  ]: SQL status: BEGIN in 5.014 seconds
[0m01:10:31.542474 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:10:31.543280 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        SUM(duration_ms / (1000 * 60)) AS total_minutes_played
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-04' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        total_minutes_played DESC

  );
[0m01:10:31.550845 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.007 seconds
[0m01:10:31.555677 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:10:31.556260 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist__dbt_tmp" rename to "minutes_per_artist"
[0m01:10:31.557553 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:10:31.558859 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m01:10:31.559241 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:10:31.559555 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m01:10:31.560267 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:10:31.562783 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."minutes_per_artist__dbt_backup"
[0m01:10:31.563313 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:10:31.563652 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
drop view if exists "airflow"."public"."minutes_per_artist__dbt_backup" cascade
[0m01:10:31.564090 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.565257 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m01:10:31.565765 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d74c70>]}
[0m01:10:31.566347 [info ] [Thread-1  ]: 2 of 9 OK created sql view model public.minutes_per_artist ..................... [[32mCREATE VIEW[0m in 5.04s]
[0m01:10:31.566985 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m01:10:31.567538 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m01:10:31.568034 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m01:10:31.568616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m01:10:31.568993 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m01:10:31.571871 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m01:10:31.572795 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m01:10:31.576058 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m01:10:31.576873 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:10:31.577120 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m01:10:31.577337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.579472 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:10:31.579710 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:10:31.579940 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-04' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        streams DESC

  );
[0m01:10:31.582179 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:10:31.585089 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:10:31.585338 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists__dbt_tmp" rename to "most_streamed_artists"
[0m01:10:31.585852 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:10:31.586721 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m01:10:31.586956 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:10:31.587160 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m01:10:31.587860 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:10:31.589416 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_artists__dbt_backup"
[0m01:10:31.589745 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:10:31.589951 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
drop view if exists "airflow"."public"."most_streamed_artists__dbt_backup" cascade
[0m01:10:31.590224 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.590911 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m01:10:31.591253 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d74c70>]}
[0m01:10:31.591643 [info ] [Thread-1  ]: 3 of 9 OK created sql view model public.most_streamed_artists .................. [[32mCREATE VIEW[0m in 0.02s]
[0m01:10:31.592056 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m01:10:31.592306 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m01:10:31.592621 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m01:10:31.592982 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m01:10:31.593195 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m01:10:31.595033 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m01:10:31.595747 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m01:10:31.598173 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m01:10:31.598890 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:10:31.599072 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m01:10:31.599238 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.600837 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:10:31.601020 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:10:31.601196 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    
    SELECT
        track_name,
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-04' as date) AND cast('2025-07-11' as date)
    GROUP BY
        track_name,
        artist_name
    ORDER BY
        streams DESC

  );
[0m01:10:31.602750 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:10:31.604405 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:10:31.604597 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs__dbt_tmp" rename to "most_streamed_songs"
[0m01:10:31.604958 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:10:31.605605 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m01:10:31.605794 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:10:31.605961 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m01:10:31.606351 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:10:31.607704 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_songs__dbt_backup"
[0m01:10:31.608009 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:10:31.608186 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
drop view if exists "airflow"."public"."most_streamed_songs__dbt_backup" cascade
[0m01:10:31.608429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.609121 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m01:10:31.609580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5176ac0>]}
[0m01:10:31.609942 [info ] [Thread-1  ]: 4 of 9 OK created sql view model public.most_streamed_songs .................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:10:31.610285 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m01:10:31.610526 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m01:10:31.610791 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m01:10:31.611083 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m01:10:31.611290 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m01:10:31.613079 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m01:10:31.613911 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m01:10:31.617292 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m01:10:31.618354 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:10:31.618579 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m01:10:31.618775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.621877 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:10:31.622310 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:10:31.622783 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    
    WITH all_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-04' as date)
    ),
    previous_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-04' as date)
    )
    SELECT
        a.artist_name
    FROM
        all_artists a
    LEFT JOIN
        previous_artists p ON a.artist_name = p.artist_name
    WHERE
        p.artist_name IS NULL

  );
[0m01:10:31.626094 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:10:31.628646 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:10:31.628898 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists__dbt_tmp" rename to "newly_discovered_artists"
[0m01:10:31.629395 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:10:31.630123 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m01:10:31.630344 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:10:31.630517 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m01:10:31.631420 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:10:31.632807 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_artists__dbt_backup"
[0m01:10:31.633164 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:10:31.633351 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
drop view if exists "airflow"."public"."newly_discovered_artists__dbt_backup" cascade
[0m01:10:31.633760 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.634478 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m01:10:31.634836 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50310d0>]}
[0m01:10:31.635214 [info ] [Thread-1  ]: 5 of 9 OK created sql view model public.newly_discovered_artists ............... [[32mCREATE VIEW[0m in 0.02s]
[0m01:10:31.635587 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m01:10:31.635924 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m01:10:31.636218 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m01:10:31.636532 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m01:10:31.636926 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m01:10:31.639037 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_tracks"
[0m01:10:31.639578 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_tracks
[0m01:10:31.642021 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_tracks"
[0m01:10:31.642606 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:10:31.642821 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: BEGIN
[0m01:10:31.643074 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.645693 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:10:31.645955 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:10:31.646172 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */

  create view "airflow"."public"."newly_discovered_tracks__dbt_tmp"
    
    
  as (
    
    WITH all_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-04' as date)
    ),
    previous_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-04' as date)
    )
    SELECT
        a.track_name
    FROM
        all_tracks a
    LEFT JOIN
        previous_tracks p ON a.track_name = p.track_name
    WHERE
        p.track_name IS NULL

  );
[0m01:10:31.647962 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:10:31.650029 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:10:31.650304 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks__dbt_tmp" rename to "newly_discovered_tracks"
[0m01:10:31.651457 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:10:31.654773 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m01:10:31.655738 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:10:31.655914 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m01:10:31.656703 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:10:31.658062 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_tracks__dbt_backup"
[0m01:10:31.658382 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:10:31.658567 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
drop view if exists "airflow"."public"."newly_discovered_tracks__dbt_backup" cascade
[0m01:10:31.658848 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.659477 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: Close
[0m01:10:31.659779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50310d0>]}
[0m01:10:31.660107 [info ] [Thread-1  ]: 6 of 9 OK created sql view model public.newly_discovered_tracks ................ [[32mCREATE VIEW[0m in 0.02s]
[0m01:10:31.660439 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m01:10:31.660650 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m01:10:31.660909 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m01:10:31.661161 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m01:10:31.661334 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m01:10:31.663744 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m01:10:31.664510 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m01:10:31.666790 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m01:10:31.667212 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:10:31.667384 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m01:10:31.667535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.669177 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:10:31.669392 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:10:31.669568 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    
    SELECT
        SUM(duration_ms / (60 * 1000)) AS total_minutes_streamed
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-04' as date) AND cast('2025-07-11' as date)

  );
[0m01:10:31.671192 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:10:31.672710 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:10:31.672893 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed__dbt_tmp" rename to "total_minutes_streamed"
[0m01:10:31.673208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:10:31.673773 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m01:10:31.673947 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:10:31.674096 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m01:10:31.674664 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:10:31.675875 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."total_minutes_streamed__dbt_backup"
[0m01:10:31.676206 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:10:31.676507 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
drop view if exists "airflow"."public"."total_minutes_streamed__dbt_backup" cascade
[0m01:10:31.676764 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.677325 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m01:10:31.677594 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45fdd90>]}
[0m01:10:31.677914 [info ] [Thread-1  ]: 7 of 9 OK created sql view model public.total_minutes_streamed ................. [[32mCREATE VIEW[0m in 0.02s]
[0m01:10:31.678237 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m01:10:31.678437 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m01:10:31.678683 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m01:10:31.678947 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m01:10:31.679158 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m01:10:31.680784 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_listened_to"
[0m01:10:31.681410 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_listened_to
[0m01:10:31.683470 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_listened_to"
[0m01:10:31.684027 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:10:31.684186 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: BEGIN
[0m01:10:31.684332 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.685699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m01:10:31.685867 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:10:31.686028 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */

  create view "airflow"."public"."tracks_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT track_name) AS total_tracks
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-04' as date) AND cast('2025-07-11' as date)

  );
[0m01:10:31.687232 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:10:31.688644 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:10:31.688816 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to__dbt_tmp" rename to "tracks_listened_to"
[0m01:10:31.689163 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:10:31.689695 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m01:10:31.689859 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:10:31.690013 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m01:10:31.690913 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:10:31.692037 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_listened_to__dbt_backup"
[0m01:10:31.693067 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:10:31.693255 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
drop view if exists "airflow"."public"."tracks_listened_to__dbt_backup" cascade
[0m01:10:31.693613 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.694202 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: Close
[0m01:10:31.694530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c7f8e0>]}
[0m01:10:31.695162 [info ] [Thread-1  ]: 8 of 9 OK created sql view model public.tracks_listened_to ..................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:10:31.695785 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m01:10:31.696119 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m01:10:31.696513 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m01:10:31.696919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m01:10:31.697125 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m01:10:31.698797 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_per_dow"
[0m01:10:31.699466 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_per_dow
[0m01:10:31.701650 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_per_dow"
[0m01:10:31.702085 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:10:31.702248 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: BEGIN
[0m01:10:31.702402 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:10:31.703964 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:10:31.704133 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:10:31.704297 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */

  create view "airflow"."public"."tracks_per_dow__dbt_tmp"
    
    
  as (
    
    SELECT
        EXTRACT(DOW FROM played_at_ts) AS day_of_week,
        EXTRACT(HOUR FROM played_at_ts) AS hour,
        SUM(duration_ms / (1000 * 60)) AS total_minutes
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-04' as date) AND cast('2025-07-11' as date)
    GROUP BY
        1, 2

  );
[0m01:10:31.706371 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:10:31.707783 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:10:31.707953 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow__dbt_tmp" rename to "tracks_per_dow"
[0m01:10:31.708306 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:10:31.708827 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m01:10:31.708991 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:10:31.709124 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m01:10:31.709624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:10:31.710778 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_per_dow__dbt_backup"
[0m01:10:31.711044 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:10:31.711226 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
drop view if exists "airflow"."public"."tracks_per_dow__dbt_backup" cascade
[0m01:10:31.711530 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.000 seconds
[0m01:10:31.712240 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: Close
[0m01:10:31.712541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '165c072f-584c-4ebb-982d-079ebb8bf96b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c7f8e0>]}
[0m01:10:31.712867 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.tracks_per_dow ......................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:10:31.713194 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m01:10:31.713858 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:31.714005 [debug] [MainThread]: On master: BEGIN
[0m01:10:31.714126 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:10:36.732226 [debug] [MainThread]: SQL status: BEGIN in 5.017 seconds
[0m01:10:36.734955 [debug] [MainThread]: On master: COMMIT
[0m01:10:36.735768 [debug] [MainThread]: Using postgres connection "master"
[0m01:10:36.736569 [debug] [MainThread]: On master: COMMIT
[0m01:10:36.737336 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:10:36.738129 [debug] [MainThread]: On master: Close
[0m01:10:36.740014 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:10:36.740865 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m01:10:36.742480 [info ] [MainThread]: 
[0m01:10:36.743666 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 15.45 seconds (15.45s).
[0m01:10:36.746732 [debug] [MainThread]: Command end result
[0m01:10:36.781611 [info ] [MainThread]: 
[0m01:10:36.782021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:10:36.782346 [info ] [MainThread]: 
[0m01:10:36.782671 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:10:36.783874 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.860342, "process_user_time": 1.118242, "process_kernel_time": 0.166184, "process_mem_max_rss": "101332", "process_out_blocks": "2653", "process_in_blocks": "0"}
[0m01:10:36.784394 [debug] [MainThread]: Command `dbt run` succeeded at 01:10:36.784312 after 15.86 seconds
[0m01:10:36.784707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f231c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63a5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d447c0>]}
[0m01:10:36.784995 [debug] [MainThread]: Flushing usage events
[0m01:10:37.319495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:24.288763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb680d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5aed970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5aed520>]}


============================== 01:14:24.290478 | ac573b18-87b5-456d-b88d-4ab75d6e0019 ==============================
[0m01:14:24.290478 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:14:24.290777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:14:24.396694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e25f10>]}
[0m01:14:24.429359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5aff730>]}
[0m01:14:24.429859 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:14:24.436413 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:14:24.479357 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:14:24.479768 [debug] [MainThread]: previous checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, current checksum: 07bdf96fb80c788ad6e986c320d1e03a6656ac2f2e3f94c4139e0d4f0126110f
[0m01:14:24.479994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ff3a60>]}
[0m01:14:24.954081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d9d310>]}
[0m01:14:24.995001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6017cd0>]}
[0m01:14:24.995288 [info ] [MainThread]: Found 9 models, 432 macros
[0m01:14:24.995521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb491cc40>]}
[0m01:14:24.996323 [info ] [MainThread]: 
[0m01:14:24.996499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:14:24.996640 [info ] [MainThread]: 
[0m01:14:24.996877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:14:24.999183 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:14:25.015569 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:14:25.015824 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:14:25.016018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:25.020138 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.004 seconds
[0m01:14:25.020695 [debug] [ThreadPool]: On list_airflow: Close
[0m01:14:25.022018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m01:14:25.025041 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:14:25.025209 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m01:14:25.025362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:25.026770 [debug] [ThreadPool]: SQL status: BEGIN in 0.001 seconds
[0m01:14:25.026960 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:14:25.027107 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:14:25.029889 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.003 seconds
[0m01:14:25.031126 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m01:14:25.031341 [debug] [ThreadPool]: On list_airflow_public: Close
[0m01:14:25.035983 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:25.036161 [debug] [MainThread]: On master: BEGIN
[0m01:14:25.036311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:14:25.037659 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m01:14:25.037832 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:25.038013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:14:25.045576 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m01:14:25.046806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4964b50>]}
[0m01:14:25.047044 [debug] [MainThread]: On master: ROLLBACK
[0m01:14:25.047251 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:25.047431 [debug] [MainThread]: On master: BEGIN
[0m01:14:25.047756 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:14:25.048106 [debug] [MainThread]: On master: COMMIT
[0m01:14:25.048322 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:25.048548 [debug] [MainThread]: On master: COMMIT
[0m01:14:25.049019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:14:25.049232 [debug] [MainThread]: On master: Close
[0m01:14:25.052119 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m01:14:25.052485 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m01:14:25.052768 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m01:14:25.052965 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m01:14:25.058147 [debug] [Thread-1  ]: Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}
[0m01:14:25.058939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68e7670>]}
[0m01:14:25.059294 [error] [Thread-1  ]: 1 of 9 ERROR creating sql view model public.artists_listened_to ................ [[31mERROR[0m in 0.01s]
[0m01:14:25.059578 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m01:14:25.059859 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m01:14:25.060077 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.artists_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}.
[0m01:14:25.060298 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m01:14:25.060717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m01:14:25.060912 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m01:14:25.062526 [debug] [Thread-1  ]: Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}
[0m01:14:25.062726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4093d90>]}
[0m01:14:25.063018 [error] [Thread-1  ]: 2 of 9 ERROR creating sql view model public.minutes_per_artist ................. [[31mERROR[0m in 0.00s]
[0m01:14:25.063261 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m01:14:25.063465 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m01:14:25.063678 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.minutes_per_artist' to be skipped because of status 'error'.  Reason: Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}.
[0m01:14:25.063912 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m01:14:25.064258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m01:14:25.064451 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m01:14:25.066025 [debug] [Thread-1  ]: Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}
[0m01:14:25.066218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40aabb0>]}
[0m01:14:25.066475 [error] [Thread-1  ]: 3 of 9 ERROR creating sql view model public.most_streamed_artists .............. [[31mERROR[0m in 0.00s]
[0m01:14:25.066719 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m01:14:25.066908 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m01:14:25.067089 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_artists' to be skipped because of status 'error'.  Reason: Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}.
[0m01:14:25.067287 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m01:14:25.067653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m01:14:25.067832 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m01:14:25.069311 [debug] [Thread-1  ]: Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}
[0m01:14:25.069509 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40419d0>]}
[0m01:14:25.069769 [error] [Thread-1  ]: 4 of 9 ERROR creating sql view model public.most_streamed_songs ................ [[31mERROR[0m in 0.00s]
[0m01:14:25.070004 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m01:14:25.070191 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m01:14:25.070379 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_songs' to be skipped because of status 'error'.  Reason: Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}.
[0m01:14:25.070593 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m01:14:25.070928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m01:14:25.071101 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m01:14:25.072525 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}
[0m01:14:25.072712 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40627c0>]}
[0m01:14:25.072975 [error] [Thread-1  ]: 5 of 9 ERROR creating sql view model public.newly_discovered_artists ........... [[31mERROR[0m in 0.00s]
[0m01:14:25.073253 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m01:14:25.073476 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m01:14:25.073657 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_artists' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}.
[0m01:14:25.073886 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m01:14:25.074240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m01:14:25.074446 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m01:14:25.076437 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}
[0m01:14:25.076627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40fe6a0>]}
[0m01:14:25.076912 [error] [Thread-1  ]: 6 of 9 ERROR creating sql view model public.newly_discovered_tracks ............ [[31mERROR[0m in 0.00s]
[0m01:14:25.077206 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m01:14:25.077408 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m01:14:25.077593 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_tracks' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}.
[0m01:14:25.077787 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m01:14:25.078113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m01:14:25.078284 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m01:14:25.079705 [debug] [Thread-1  ]: Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}
[0m01:14:25.079885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4444160>]}
[0m01:14:25.080144 [error] [Thread-1  ]: 7 of 9 ERROR creating sql view model public.total_minutes_streamed ............. [[31mERROR[0m in 0.00s]
[0m01:14:25.080393 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m01:14:25.080580 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m01:14:25.080762 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.total_minutes_streamed' to be skipped because of status 'error'.  Reason: Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}.
[0m01:14:25.080955 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m01:14:25.081264 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m01:14:25.081447 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m01:14:25.083066 [debug] [Thread-1  ]: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}
[0m01:14:25.083256 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4091d90>]}
[0m01:14:25.083518 [error] [Thread-1  ]: 8 of 9 ERROR creating sql view model public.tracks_listened_to ................. [[31mERROR[0m in 0.00s]
[0m01:14:25.083752 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m01:14:25.083930 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m01:14:25.084103 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}.
[0m01:14:25.084307 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m01:14:25.084656 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m01:14:25.084866 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m01:14:25.086286 [debug] [Thread-1  ]: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}
[0m01:14:25.086479 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac573b18-87b5-456d-b88d-4ab75d6e0019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb40b0910>]}
[0m01:14:25.086732 [error] [Thread-1  ]: 9 of 9 ERROR creating sql view model public.tracks_per_dow ..................... [[31mERROR[0m in 0.00s]
[0m01:14:25.087026 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m01:14:25.087257 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_per_dow' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}.
[0m01:14:25.087780 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:25.087934 [debug] [MainThread]: On master: BEGIN
[0m01:14:25.088067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:14:30.101541 [debug] [MainThread]: SQL status: BEGIN in 5.013 seconds
[0m01:14:30.104701 [debug] [MainThread]: On master: COMMIT
[0m01:14:30.105594 [debug] [MainThread]: Using postgres connection "master"
[0m01:14:30.106398 [debug] [MainThread]: On master: COMMIT
[0m01:14:30.107538 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:14:30.108409 [debug] [MainThread]: On master: Close
[0m01:14:30.109954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:30.110810 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m01:14:30.111427 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m01:14:30.112811 [info ] [MainThread]: 
[0m01:14:30.113706 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m01:14:30.116613 [debug] [MainThread]: Command end result
[0m01:14:30.151940 [info ] [MainThread]: 
[0m01:14:30.152301 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successs, and 0 warnings:[0m
[0m01:14:30.152545 [info ] [MainThread]: 
[0m01:14:30.152806 [error] [MainThread]:   Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}
[0m01:14:30.153008 [info ] [MainThread]: 
[0m01:14:30.153226 [error] [MainThread]:   Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}
[0m01:14:30.153443 [info ] [MainThread]: 
[0m01:14:30.153686 [error] [MainThread]:   Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}
[0m01:14:30.153868 [info ] [MainThread]: 
[0m01:14:30.154067 [error] [MainThread]:   Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}
[0m01:14:30.154236 [info ] [MainThread]: 
[0m01:14:30.154436 [error] [MainThread]:   Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}
[0m01:14:30.154603 [info ] [MainThread]: 
[0m01:14:30.154791 [error] [MainThread]:   Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}
[0m01:14:30.154991 [info ] [MainThread]: 
[0m01:14:30.155257 [error] [MainThread]:   Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}
[0m01:14:30.155469 [info ] [MainThread]: 
[0m01:14:30.155782 [error] [MainThread]:   Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}
[0m01:14:30.155968 [info ] [MainThread]: 
[0m01:14:30.156191 [error] [MainThread]:   Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}
[0m01:14:30.156416 [info ] [MainThread]: 
[0m01:14:30.156664 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
[0m01:14:30.157893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.894037, "process_user_time": 1.274168, "process_kernel_time": 0.138211, "process_mem_max_rss": "100368", "process_out_blocks": "2575", "command_success": false, "process_in_blocks": "0"}
[0m01:14:30.158348 [debug] [MainThread]: Command `dbt run` failed at 01:14:30.158281 after 5.89 seconds
[0m01:14:30.158670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb680d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4e25f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6017cd0>]}
[0m01:14:30.158944 [debug] [MainThread]: Flushing usage events
[0m01:14:30.678758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:38.265080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81012fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807ac3a0>]}


============================== 01:15:38.267634 | 6301693a-f781-4e2d-bb57-1296110d250f ==============================
[0m01:15:38.267634 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:15:38.268041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:15:38.365289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802ad520>]}
[0m01:15:38.390677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d026d0>]}
[0m01:15:38.391032 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:15:38.399162 [debug] [MainThread]: checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f, vars: {}, profile: , target: , version: 1.9.0b2
[0m01:15:38.465436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:15:38.465894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:15:38.485308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f271af0>]}
[0m01:15:38.534964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1be2b0>]}
[0m01:15:38.535374 [info ] [MainThread]: Found 9 models, 432 macros
[0m01:15:38.535746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f21d2b0>]}
[0m01:15:38.537192 [info ] [MainThread]: 
[0m01:15:38.537450 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:15:38.537636 [info ] [MainThread]: 
[0m01:15:38.538035 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:15:38.542903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:15:38.583221 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:15:38.583541 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:15:38.583694 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:38.593047 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m01:15:38.593990 [debug] [ThreadPool]: On list_airflow: Close
[0m01:15:38.596171 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m01:15:38.600325 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:15:38.600544 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m01:15:38.600677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:38.606912 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m01:15:38.607224 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:15:38.607456 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:15:38.612322 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.005 seconds
[0m01:15:38.614846 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m01:15:38.615305 [debug] [ThreadPool]: On list_airflow_public: Close
[0m01:15:38.621309 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.621554 [debug] [MainThread]: On master: BEGIN
[0m01:15:38.621716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:38.624978 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:15:38.625218 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.625423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:15:38.635231 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m01:15:38.636628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1be5b0>]}
[0m01:15:38.637096 [debug] [MainThread]: On master: ROLLBACK
[0m01:15:38.637522 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.637798 [debug] [MainThread]: On master: BEGIN
[0m01:15:38.638256 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:15:38.638642 [debug] [MainThread]: On master: COMMIT
[0m01:15:38.638962 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.639227 [debug] [MainThread]: On master: COMMIT
[0m01:15:38.639423 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:38.639647 [debug] [MainThread]: On master: Close
[0m01:15:38.641800 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m01:15:38.642146 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m01:15:38.642481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m01:15:38.642719 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m01:15:38.648589 [debug] [Thread-1  ]: Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}
[0m01:15:38.649557 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81081430>]}
[0m01:15:38.649878 [error] [Thread-1  ]: 1 of 9 ERROR creating sql view model public.artists_listened_to ................ [[31mERROR[0m in 0.01s]
[0m01:15:38.650170 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m01:15:38.650379 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m01:15:38.650593 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.artists_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}.
[0m01:15:38.650818 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m01:15:38.651197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m01:15:38.651410 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m01:15:38.653915 [debug] [Thread-1  ]: Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}
[0m01:15:38.654111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e55ad90>]}
[0m01:15:38.654374 [error] [Thread-1  ]: 2 of 9 ERROR creating sql view model public.minutes_per_artist ................. [[31mERROR[0m in 0.00s]
[0m01:15:38.654629 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m01:15:38.654829 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m01:15:38.655010 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.minutes_per_artist' to be skipped because of status 'error'.  Reason: Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}.
[0m01:15:38.655219 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m01:15:38.655529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m01:15:38.655708 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m01:15:38.657334 [debug] [Thread-1  ]: Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}
[0m01:15:38.657505 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4f4bb0>]}
[0m01:15:38.657750 [error] [Thread-1  ]: 3 of 9 ERROR creating sql view model public.most_streamed_artists .............. [[31mERROR[0m in 0.00s]
[0m01:15:38.657987 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m01:15:38.658174 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m01:15:38.658352 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_artists' to be skipped because of status 'error'.  Reason: Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}.
[0m01:15:38.658552 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m01:15:38.658840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m01:15:38.659007 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m01:15:38.661312 [debug] [Thread-1  ]: Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}
[0m01:15:38.661531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e50ac40>]}
[0m01:15:38.661809 [error] [Thread-1  ]: 4 of 9 ERROR creating sql view model public.most_streamed_songs ................ [[31mERROR[0m in 0.00s]
[0m01:15:38.662044 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m01:15:38.662218 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m01:15:38.662390 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.most_streamed_songs' to be skipped because of status 'error'.  Reason: Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}.
[0m01:15:38.662589 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m01:15:38.662900 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m01:15:38.663074 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m01:15:38.664519 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}
[0m01:15:38.664692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e4a1a60>]}
[0m01:15:38.664966 [error] [Thread-1  ]: 5 of 9 ERROR creating sql view model public.newly_discovered_artists ........... [[31mERROR[0m in 0.00s]
[0m01:15:38.665208 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m01:15:38.665379 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m01:15:38.665559 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_artists' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}.
[0m01:15:38.665768 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m01:15:38.666075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m01:15:38.666250 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m01:15:38.668319 [debug] [Thread-1  ]: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}
[0m01:15:38.668500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e646220>]}
[0m01:15:38.668770 [error] [Thread-1  ]: 6 of 9 ERROR creating sql view model public.newly_discovered_tracks ............ [[31mERROR[0m in 0.00s]
[0m01:15:38.669001 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m01:15:38.669176 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m01:15:38.669360 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.newly_discovered_tracks' to be skipped because of status 'error'.  Reason: Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}.
[0m01:15:38.669564 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m01:15:38.669897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m01:15:38.670067 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m01:15:38.671495 [debug] [Thread-1  ]: Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}
[0m01:15:38.671685 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e5f1520>]}
[0m01:15:38.671934 [error] [Thread-1  ]: 7 of 9 ERROR creating sql view model public.total_minutes_streamed ............. [[31mERROR[0m in 0.00s]
[0m01:15:38.672172 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m01:15:38.672343 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m01:15:38.672518 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.total_minutes_streamed' to be skipped because of status 'error'.  Reason: Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}.
[0m01:15:38.672730 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m01:15:38.673065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m01:15:38.673233 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m01:15:38.674718 [debug] [Thread-1  ]: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}
[0m01:15:38.674888 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e65d340>]}
[0m01:15:38.675121 [error] [Thread-1  ]: 8 of 9 ERROR creating sql view model public.tracks_listened_to ................. [[31mERROR[0m in 0.00s]
[0m01:15:38.675338 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m01:15:38.675503 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m01:15:38.675675 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_listened_to' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}.
[0m01:15:38.675873 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m01:15:38.676176 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m01:15:38.676337 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m01:15:38.677764 [debug] [Thread-1  ]: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}
[0m01:15:38.677939 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6301693a-f781-4e2d-bb57-1296110d250f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e54ef10>]}
[0m01:15:38.678197 [error] [Thread-1  ]: 9 of 9 ERROR creating sql view model public.tracks_per_dow ..................... [[31mERROR[0m in 0.00s]
[0m01:15:38.678422 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m01:15:38.678625 [debug] [Thread-4  ]: Marking all children of 'model.spotify_wrapped.tracks_per_dow' to be skipped because of status 'error'.  Reason: Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}.
[0m01:15:38.679397 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.679559 [debug] [MainThread]: On master: BEGIN
[0m01:15:38.679712 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:38.681580 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:15:38.681741 [debug] [MainThread]: On master: COMMIT
[0m01:15:38.681882 [debug] [MainThread]: Using postgres connection "master"
[0m01:15:38.682006 [debug] [MainThread]: On master: COMMIT
[0m01:15:38.682182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:15:38.682320 [debug] [MainThread]: On master: Close
[0m01:15:38.682507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:38.682657 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m01:15:38.682817 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m01:15:38.683008 [info ] [MainThread]: 
[0m01:15:38.683172 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m01:15:38.683751 [debug] [MainThread]: Command end result
[0m01:15:38.701149 [info ] [MainThread]: 
[0m01:15:38.701435 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successs, and 0 warnings:[0m
[0m01:15:38.701753 [info ] [MainThread]: 
[0m01:15:38.701975 [error] [MainThread]:   Compilation Error in model artists_listened_to (models/artists_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to artists_listened_to = {}
[0m01:15:38.702156 [info ] [MainThread]: 
[0m01:15:38.702327 [error] [MainThread]:   Compilation Error in model minutes_per_artist (models/minutes_per_artist.sql)
  Required var 'start_date' not found in config:
  Vars supplied to minutes_per_artist = {}
[0m01:15:38.702472 [info ] [MainThread]: 
[0m01:15:38.702638 [error] [MainThread]:   Compilation Error in model most_streamed_artists (models/most_streamed_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_artists = {}
[0m01:15:38.702790 [info ] [MainThread]: 
[0m01:15:38.702959 [error] [MainThread]:   Compilation Error in model most_streamed_songs (models/most_streamed_songs.sql)
  Required var 'start_date' not found in config:
  Vars supplied to most_streamed_songs = {}
[0m01:15:38.703103 [info ] [MainThread]: 
[0m01:15:38.703269 [error] [MainThread]:   Compilation Error in model newly_discovered_artists (models/newly_discovered_artists.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_artists = {}
[0m01:15:38.703411 [info ] [MainThread]: 
[0m01:15:38.703572 [error] [MainThread]:   Compilation Error in model newly_discovered_tracks (models/newly_discovered_tracks.sql)
  Required var 'start_date' not found in config:
  Vars supplied to newly_discovered_tracks = {}
[0m01:15:38.703719 [info ] [MainThread]: 
[0m01:15:38.703883 [error] [MainThread]:   Compilation Error in model total_minutes_streamed (models/total_minutes_streamed.sql)
  Required var 'start_date' not found in config:
  Vars supplied to total_minutes_streamed = {}
[0m01:15:38.704023 [info ] [MainThread]: 
[0m01:15:38.704185 [error] [MainThread]:   Compilation Error in model tracks_listened_to (models/tracks_listened_to.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_listened_to = {}
[0m01:15:38.704342 [info ] [MainThread]: 
[0m01:15:38.704503 [error] [MainThread]:   Compilation Error in model tracks_per_dow (models/tracks_per_dow.sql)
  Required var 'start_date' not found in config:
  Vars supplied to tracks_per_dow = {}
[0m01:15:38.704643 [info ] [MainThread]: 
[0m01:15:38.704805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=9 SKIP=0 TOTAL=9
[0m01:15:38.705350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4690354, "process_user_time": 0.826875, "process_kernel_time": 0.385875, "process_mem_max_rss": "96468", "process_out_blocks": "1735", "command_success": false, "process_in_blocks": "0"}
[0m01:15:38.705640 [debug] [MainThread]: Command `dbt run` failed at 01:15:38.705596 after 0.47 seconds
[0m01:15:38.705857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80fa7250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f54dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802ad520>]}
[0m01:15:38.706057 [debug] [MainThread]: Flushing usage events
[0m01:15:39.176295 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:50.644980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948751f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b4ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b4cfd0>]}


============================== 01:19:50.647281 | 60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5 ==============================
[0m01:19:50.647281 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:19:50.647778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-10", "end_date": "2025-07-11" }', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:50.677331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1f41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4cba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4cbfd0>]}


============================== 01:19:50.679532 | 286d4ec0-c52c-4c0f-812d-9a0318f32bd1 ==============================
[0m01:19:50.679532 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m01:19:50.681660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-10", "end_date": "2025-07-11" }', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:50.753003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b688e0>]}
[0m01:19:50.778105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4e68e0>]}
[0m01:19:50.782953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e347c0>]}
[0m01:19:50.784756 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:19:50.800841 [debug] [MainThread]: checksum: 15db23c23a855526e0d318fcc3125f85541d1a99e00a28fe27ede77919359a68, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-10'}, profile: , target: , version: 1.9.0b2
[0m01:19:50.816456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b79b7c0>]}
[0m01:19:50.817590 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m01:19:50.828827 [debug] [MainThread]: checksum: 15db23c23a855526e0d318fcc3125f85541d1a99e00a28fe27ede77919359a68, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-10'}, profile: , target: , version: 1.9.0b2
[0m01:19:50.870552 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:19:50.870950 [debug] [MainThread]: previous checksum: 15db23c23a855526e0d318fcc3125f85541d1a99e00a28fe27ede77919359a68, current checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f
[0m01:19:50.871470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94060af0>]}
[0m01:19:50.898684 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m01:19:50.899449 [debug] [MainThread]: previous checksum: 15db23c23a855526e0d318fcc3125f85541d1a99e00a28fe27ede77919359a68, current checksum: 4cfbbe2a671212f062e88a43cba5322b30b7e3e8e91b953aa4de249eeaade60f
[0m01:19:50.900494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9dbaf0>]}
[0m01:19:51.400936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92de0b20>]}
[0m01:19:51.429169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b46e0d0>]}
[0m01:19:51.471601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92a882b0>]}
[0m01:19:51.471935 [info ] [MainThread]: Found 9 models, 432 macros
[0m01:19:51.472413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92983ca0>]}
[0m01:19:51.473175 [info ] [MainThread]: 
[0m01:19:51.474025 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:51.474473 [info ] [MainThread]: 
[0m01:19:51.475243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:19:51.479441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:19:51.493023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5ea400>]}
[0m01:19:51.493392 [info ] [MainThread]: Found 9 models, 432 macros
[0m01:19:51.493615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b307cd0>]}
[0m01:19:51.494605 [info ] [MainThread]: 
[0m01:19:51.494792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:51.494934 [info ] [MainThread]: 
[0m01:19:51.495211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m01:19:51.498201 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m01:19:51.510674 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:19:51.511065 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:19:51.511306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:51.525728 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m01:19:51.526082 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m01:19:51.526278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:56.538821 [debug] [ThreadPool]: SQL status: SELECT 4 in 5.025 seconds
[0m01:19:56.544987 [debug] [ThreadPool]: SQL status: SELECT 4 in 5.016 seconds
[0m01:19:56.552118 [debug] [ThreadPool]: On list_airflow: Close
[0m01:19:56.561657 [debug] [ThreadPool]: On list_airflow: Close
[0m01:19:56.563830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m01:19:56.569290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m01:19:56.579520 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:19:56.580083 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m01:19:56.580394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:56.583475 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m01:19:56.583836 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:19:56.584109 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:19:56.584327 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:19:56.584705 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m01:19:56.585032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:56.587839 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.003 seconds
[0m01:19:56.587980 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m01:19:56.588358 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m01:19:56.588622 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m01:19:56.590391 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m01:19:56.590861 [debug] [ThreadPool]: On list_airflow_public: Close
[0m01:19:56.591495 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.003 seconds
[0m01:19:56.593896 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m01:19:56.594497 [debug] [ThreadPool]: On list_airflow_public: Close
[0m01:19:56.598519 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:56.599690 [debug] [MainThread]: On master: BEGIN
[0m01:19:56.601404 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:56.601622 [debug] [MainThread]: On master: BEGIN
[0m01:19:56.601807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:56.601447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:56.604771 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m01:19:56.604946 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:56.605146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:19:56.611438 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m01:19:56.614255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3be670>]}
[0m01:19:56.615057 [debug] [MainThread]: On master: ROLLBACK
[0m01:19:56.615426 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:56.615637 [debug] [MainThread]: On master: BEGIN
[0m01:19:56.615931 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:19:56.616107 [debug] [MainThread]: On master: COMMIT
[0m01:19:56.616256 [debug] [MainThread]: Using postgres connection "master"
[0m01:19:56.616406 [debug] [MainThread]: On master: COMMIT
[0m01:19:56.616634 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:19:56.616845 [debug] [MainThread]: On master: Close
[0m01:19:56.620668 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m01:19:56.621155 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m01:19:56.621625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m01:19:56.621974 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m01:19:56.627805 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m01:19:56.628912 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m01:19:56.646164 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m01:19:56.647175 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:19:56.647350 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m01:19:56.647526 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.640518 [debug] [MainThread]: SQL status: BEGIN in 5.036 seconds
[0m01:20:01.645240 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:01.645968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m01:20:01.662868 [debug] [MainThread]: SQL status: SELECT 9 in 0.016 seconds
[0m01:20:01.666279 [debug] [Thread-1  ]: SQL status: BEGIN in 5.017 seconds
[0m01:20:01.668999 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.669515 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT artist_name) AS total_artists
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)

  );
[0m01:20:01.671290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929dad60>]}
[0m01:20:01.673903 [debug] [MainThread]: On master: ROLLBACK
[0m01:20:01.674566 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:01.674872 [debug] [MainThread]: On master: BEGIN
[0m01:20:01.675477 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m01:20:01.675773 [debug] [MainThread]: On master: COMMIT
[0m01:20:01.676004 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:01.676206 [debug] [MainThread]: On master: COMMIT
[0m01:20:01.676325 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.006 seconds
[0m01:20:01.676476 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:20:01.681736 [debug] [MainThread]: On master: Close
[0m01:20:01.694724 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m01:20:01.695607 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m01:20:01.696173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m01:20:01.696580 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m01:20:01.698105 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.698577 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to" rename to "artists_listened_to__dbt_backup"
[0m01:20:01.699255 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.701392 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.701713 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to__dbt_tmp" rename to "artists_listened_to"
[0m01:20:01.702297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.705251 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.711923 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m01:20:01.719299 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m01:20:01.720485 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.722490 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m01:20:01.723373 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:01.727524 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."artists_listened_to__dbt_backup"
[0m01:20:01.730027 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.730258 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
drop view if exists "airflow"."public"."artists_listened_to__dbt_backup" cascade
[0m01:20:01.734120 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.004 seconds
[0m01:20:01.738872 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m01:20:01.739007 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.740869 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aba8e80>]}
[0m01:20:01.741777 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.artists_listened_to .................... [[32mCREATE VIEW[0m in 5.12s]
[0m01:20:01.742439 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m01:20:01.742829 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m01:20:01.743350 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:01.744093 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m01:20:01.744315 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.743806 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m01:20:01.744901 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m01:20:01.745159 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m01:20:01.747615 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.748353 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m01:20:01.750961 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.751572 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.751786 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m01:20:01.752013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.755954 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m01:20:01.756194 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.756374 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        SUM(duration_ms / (1000 * 60)) AS total_minutes_played
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        total_minutes_played DESC

  );
[0m01:20:01.758936 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:01.760824 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.761016 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist" rename to "minutes_per_artist__dbt_backup"
[0m01:20:01.761396 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.763113 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.763354 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist__dbt_tmp" rename to "minutes_per_artist"
[0m01:20:01.763904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.764902 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m01:20:01.765142 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.765322 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m01:20:01.765929 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:01.767196 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."minutes_per_artist__dbt_backup"
[0m01:20:01.767521 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:01.767708 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
drop view if exists "airflow"."public"."minutes_per_artist__dbt_backup" cascade
[0m01:20:01.769112 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:01.769715 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m01:20:01.770036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b71bb80>]}
[0m01:20:01.770440 [info ] [Thread-1  ]: 2 of 9 OK created sql view model public.minutes_per_artist ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m01:20:01.770746 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m01:20:01.770958 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m01:20:01.771215 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m01:20:01.771443 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m01:20:01.771835 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m01:20:01.774682 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.775454 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m01:20:01.777581 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.778091 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.778263 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m01:20:01.778422 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.780300 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:20:01.780677 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.780897 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        streams DESC

  );
[0m01:20:01.782526 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:20:01.784502 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.784692 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists" rename to "most_streamed_artists__dbt_backup"
[0m01:20:01.785063 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.786558 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.786749 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists__dbt_tmp" rename to "most_streamed_artists"
[0m01:20:01.787109 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.787733 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m01:20:01.787938 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.788143 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m01:20:01.788579 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:01.790072 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_artists__dbt_backup"
[0m01:20:01.790406 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:01.790594 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
drop view if exists "airflow"."public"."most_streamed_artists__dbt_backup" cascade
[0m01:20:01.791642 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:01.792272 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m01:20:01.792565 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5ae1c0>]}
[0m01:20:01.792879 [info ] [Thread-1  ]: 3 of 9 OK created sql view model public.most_streamed_artists .................. [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:01.793159 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m01:20:01.793554 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m01:20:01.794050 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m01:20:01.794442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m01:20:01.794719 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m01:20:01.797365 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.798013 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m01:20:01.800559 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.801425 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.801603 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m01:20:01.801755 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.803984 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:20:01.804182 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.804360 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    
    SELECT
        track_name,
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        track_name,
        artist_name
    ORDER BY
        streams DESC

  );
[0m01:20:01.806191 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:01.809280 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.809587 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs" rename to "most_streamed_songs__dbt_backup"
[0m01:20:01.810129 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.811904 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.812202 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs__dbt_tmp" rename to "most_streamed_songs"
[0m01:20:01.813191 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.815751 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m01:20:01.816369 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.816987 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m01:20:01.819672 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:01.828202 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_songs__dbt_backup"
[0m01:20:01.828928 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:01.829426 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
drop view if exists "airflow"."public"."most_streamed_songs__dbt_backup" cascade
[0m01:20:01.835635 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.005 seconds
[0m01:20:01.839855 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m01:20:01.841348 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aba8040>]}
[0m01:20:01.843112 [info ] [Thread-1  ]: 4 of 9 OK created sql view model public.most_streamed_songs .................... [[32mCREATE VIEW[0m in 0.05s]
[0m01:20:01.843586 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m01:20:01.843967 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m01:20:01.844666 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m01:20:01.845094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m01:20:01.845619 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m01:20:01.849493 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.851639 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m01:20:01.854919 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.856885 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.857639 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m01:20:01.858214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.865630 [debug] [Thread-1  ]: SQL status: BEGIN in 0.007 seconds
[0m01:20:01.866415 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.866791 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    
    WITH all_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-10' as date)
    ),
    previous_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-10' as date)
    )
    SELECT
        a.artist_name
    FROM
        all_artists a
    LEFT JOIN
        previous_artists p ON a.artist_name = p.artist_name
    WHERE
        p.artist_name IS NULL

  );
[0m01:20:01.870162 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m01:20:01.879807 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.881358 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists" rename to "newly_discovered_artists__dbt_backup"
[0m01:20:01.883777 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:01.887422 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.887923 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists__dbt_tmp" rename to "newly_discovered_artists"
[0m01:20:01.889173 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:01.892702 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m01:20:01.893209 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.893498 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m01:20:01.894589 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:01.897825 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_artists__dbt_backup"
[0m01:20:01.899826 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:01.900220 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
drop view if exists "airflow"."public"."newly_discovered_artists__dbt_backup" cascade
[0m01:20:01.903328 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m01:20:01.904875 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m01:20:01.905666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b71bb80>]}
[0m01:20:01.906152 [info ] [Thread-1  ]: 5 of 9 OK created sql view model public.newly_discovered_artists ............... [[32mCREATE VIEW[0m in 0.06s]
[0m01:20:01.906710 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m01:20:01.907135 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:01.907859 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m01:20:01.908265 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m01:20:01.908536 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:01.910586 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.911657 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:01.915719 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.917150 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.917558 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: BEGIN
[0m01:20:01.917964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.925646 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m01:20:01.926253 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.926794 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */

  create view "airflow"."public"."newly_discovered_tracks__dbt_tmp"
    
    
  as (
    
    WITH all_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-10' as date)
    ),
    previous_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-10' as date)
    )
    SELECT
        a.track_name
    FROM
        all_tracks a
    LEFT JOIN
        previous_tracks p ON a.track_name = p.track_name
    WHERE
        p.track_name IS NULL

  );
[0m01:20:01.929311 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:01.933190 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.934626 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks" rename to "newly_discovered_tracks__dbt_backup"
[0m01:20:01.935482 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.937601 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.937852 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks__dbt_tmp" rename to "newly_discovered_tracks"
[0m01:20:01.938302 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.939487 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m01:20:01.939808 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.940261 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m01:20:01.941827 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:01.948063 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_tracks__dbt_backup"
[0m01:20:01.949859 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:01.950472 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
drop view if exists "airflow"."public"."newly_discovered_tracks__dbt_backup" cascade
[0m01:20:01.951752 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:01.952441 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: Close
[0m01:20:01.952761 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa76eb0>]}
[0m01:20:01.953114 [info ] [Thread-1  ]: 6 of 9 OK created sql view model public.newly_discovered_tracks ................ [[32mCREATE VIEW[0m in 0.04s]
[0m01:20:01.953448 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:01.953699 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m01:20:01.953979 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m01:20:01.954219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m01:20:01.954423 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m01:20:01.956509 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.957209 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m01:20:01.960226 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.961075 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.961241 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m01:20:01.961423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.964597 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:20:01.964839 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.965024 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    
    SELECT
        SUM(duration_ms / (60 * 1000)) AS total_minutes_streamed
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)

  );
[0m01:20:01.966925 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:01.969214 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.969471 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed" rename to "total_minutes_streamed__dbt_backup"
[0m01:20:01.970016 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.971856 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.972213 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed__dbt_tmp" rename to "total_minutes_streamed"
[0m01:20:01.972711 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.973354 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m01:20:01.973591 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.973799 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m01:20:01.974729 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:01.976501 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."total_minutes_streamed__dbt_backup"
[0m01:20:01.976987 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:01.977230 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
drop view if exists "airflow"."public"."total_minutes_streamed__dbt_backup" cascade
[0m01:20:01.978496 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:01.979144 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m01:20:01.979524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7966a0>]}
[0m01:20:01.979898 [info ] [Thread-1  ]: 7 of 9 OK created sql view model public.total_minutes_streamed ................. [[32mCREATE VIEW[0m in 0.03s]
[0m01:20:01.980190 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m01:20:01.980583 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m01:20:01.981013 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m01:20:01.981262 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m01:20:01.981439 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m01:20:01.983166 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.983719 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_listened_to
[0m01:20:01.985850 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.986283 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.986444 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: BEGIN
[0m01:20:01.986597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:01.988285 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:20:01.988721 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.988926 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */

  create view "airflow"."public"."tracks_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT track_name) AS total_tracks
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)

  );
[0m01:20:01.990234 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:20:01.992038 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.992219 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to" rename to "tracks_listened_to__dbt_backup"
[0m01:20:01.992535 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.993949 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.994119 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to__dbt_tmp" rename to "tracks_listened_to"
[0m01:20:01.994405 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:01.995098 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m01:20:01.995277 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.995519 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m01:20:01.995950 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:01.998055 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_listened_to__dbt_backup"
[0m01:20:01.998421 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:01.998703 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
drop view if exists "airflow"."public"."tracks_listened_to__dbt_backup" cascade
[0m01:20:01.999639 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:02.000207 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: Close
[0m01:20:02.000504 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7ffc10>]}
[0m01:20:02.000843 [info ] [Thread-1  ]: 8 of 9 OK created sql view model public.tracks_listened_to ..................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:02.001122 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m01:20:02.001413 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m01:20:02.001670 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m01:20:02.001892 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m01:20:02.002064 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m01:20:02.003671 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.004211 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_per_dow
[0m01:20:02.006404 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.006859 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.007030 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: BEGIN
[0m01:20:02.007177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:02.008730 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:20:02.008917 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.009097 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */

  create view "airflow"."public"."tracks_per_dow__dbt_tmp"
    
    
  as (
    
    SELECT
        EXTRACT(DOW FROM played_at_ts) AS day_of_week,
        EXTRACT(HOUR FROM played_at_ts) AS hour,
        SUM(duration_ms / (1000 * 60)) AS total_minutes
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        1, 2

  );
[0m01:20:02.011525 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:02.013621 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.014023 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow" rename to "tracks_per_dow__dbt_backup"
[0m01:20:02.014501 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:02.016104 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.016290 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow__dbt_tmp" rename to "tracks_per_dow"
[0m01:20:02.016648 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:02.017213 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m01:20:02.017388 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.017548 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m01:20:02.018222 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:02.019559 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_per_dow__dbt_backup"
[0m01:20:02.019832 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:02.020007 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
drop view if exists "airflow"."public"."tracks_per_dow__dbt_backup" cascade
[0m01:20:02.021122 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:02.022138 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: Close
[0m01:20:02.022562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '286d4ec0-c52c-4c0f-812d-9a0318f32bd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7b2640>]}
[0m01:20:02.023047 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.tracks_per_dow ......................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:02.023345 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m01:20:02.024796 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:02.025009 [debug] [MainThread]: On master: BEGIN
[0m01:20:02.025194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:02.029783 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m01:20:02.030000 [debug] [MainThread]: On master: COMMIT
[0m01:20:02.030135 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:02.030259 [debug] [MainThread]: On master: COMMIT
[0m01:20:02.030487 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:20:02.030705 [debug] [MainThread]: On master: Close
[0m01:20:02.030960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:02.031133 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m01:20:02.031469 [info ] [MainThread]: 
[0m01:20:02.031718 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m01:20:02.032547 [debug] [MainThread]: Command end result
[0m01:20:02.055817 [info ] [MainThread]: 
[0m01:20:02.056163 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:02.056366 [info ] [MainThread]: 
[0m01:20:02.056592 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:20:02.058519 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.426486, "process_user_time": 1.688348, "process_kernel_time": 0.330831, "process_mem_max_rss": "101336", "process_out_blocks": "2658", "process_in_blocks": "0"}
[0m01:20:02.059241 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:02.059169 after 11.43 seconds
[0m01:20:02.059731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d1f41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c4e68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d042100>]}
[0m01:20:02.059983 [debug] [MainThread]: Flushing usage events
[0m01:20:02.569332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:20:06.780323 [debug] [Thread-1  ]: SQL status: BEGIN in 5.034 seconds
[0m01:20:06.783665 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:06.784234 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT artist_name) AS total_artists
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)

  );
[0m01:20:06.796751 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.012 seconds
[0m01:20:06.814227 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:06.814711 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to" rename to "artists_listened_to__dbt_backup"
[0m01:20:06.815732 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:06.818013 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:06.818277 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to__dbt_tmp" rename to "artists_listened_to"
[0m01:20:06.818877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.831063 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m01:20:06.831488 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:06.831733 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m01:20:06.832649 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:06.836391 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."artists_listened_to__dbt_backup"
[0m01:20:06.838555 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m01:20:06.839024 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
drop view if exists "airflow"."public"."artists_listened_to__dbt_backup" cascade
[0m01:20:06.840983 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.002 seconds
[0m01:20:06.843716 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m01:20:06.845587 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92468e80>]}
[0m01:20:06.846421 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.artists_listened_to .................... [[32mCREATE VIEW[0m in 5.15s]
[0m01:20:06.846999 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m01:20:06.848032 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m01:20:06.851014 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m01:20:06.851613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m01:20:06.851933 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m01:20:06.857401 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.858662 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m01:20:06.861818 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.862613 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.862801 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m01:20:06.862981 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:06.866418 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:20:06.866775 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.867007 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        SUM(duration_ms / (1000 * 60)) AS total_minutes_played
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        total_minutes_played DESC

  );
[0m01:20:06.869015 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:06.871764 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.872028 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist" rename to "minutes_per_artist__dbt_backup"
[0m01:20:06.872963 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:06.874930 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.875151 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist__dbt_tmp" rename to "minutes_per_artist"
[0m01:20:06.875694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.876391 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m01:20:06.876599 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.876795 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m01:20:06.877562 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:06.879198 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."minutes_per_artist__dbt_backup"
[0m01:20:06.879533 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m01:20:06.879738 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
drop view if exists "airflow"."public"."minutes_per_artist__dbt_backup" cascade
[0m01:20:06.881051 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:06.881778 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m01:20:06.882136 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92db4b80>]}
[0m01:20:06.882551 [info ] [Thread-1  ]: 2 of 9 OK created sql view model public.minutes_per_artist ..................... [[32mCREATE VIEW[0m in 0.03s]
[0m01:20:06.882870 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m01:20:06.883119 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m01:20:06.883433 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m01:20:06.883707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m01:20:06.883888 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m01:20:06.886389 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.887059 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m01:20:06.889511 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.890061 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.890240 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m01:20:06.890417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:06.894283 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m01:20:06.894542 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.894728 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        streams DESC

  );
[0m01:20:06.897402 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:06.899867 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.900125 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists" rename to "most_streamed_artists__dbt_backup"
[0m01:20:06.900871 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.902373 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.902558 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists__dbt_tmp" rename to "most_streamed_artists"
[0m01:20:06.902896 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.903560 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m01:20:06.903768 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.903946 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m01:20:06.904815 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:06.906619 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_artists__dbt_backup"
[0m01:20:06.906962 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m01:20:06.907158 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
drop view if exists "airflow"."public"."most_streamed_artists__dbt_backup" cascade
[0m01:20:06.908338 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:06.909024 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m01:20:06.909338 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c4e1c0>]}
[0m01:20:06.909784 [info ] [Thread-1  ]: 3 of 9 OK created sql view model public.most_streamed_artists .................. [[32mCREATE VIEW[0m in 0.03s]
[0m01:20:06.910075 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m01:20:06.910268 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m01:20:06.910578 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m01:20:06.910839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m01:20:06.911020 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m01:20:06.912835 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.913369 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m01:20:06.915964 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.916594 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.916881 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m01:20:06.917094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:06.919151 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:20:06.919332 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.919542 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    
    SELECT
        track_name,
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        track_name,
        artist_name
    ORDER BY
        streams DESC

  );
[0m01:20:06.921350 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:06.924825 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.925217 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs" rename to "most_streamed_songs__dbt_backup"
[0m01:20:06.926109 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m01:20:06.927980 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.928213 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs__dbt_tmp" rename to "most_streamed_songs"
[0m01:20:06.928801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.929546 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m01:20:06.929795 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.930412 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m01:20:06.931818 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:06.933422 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_songs__dbt_backup"
[0m01:20:06.933727 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m01:20:06.933914 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
drop view if exists "airflow"."public"."most_streamed_songs__dbt_backup" cascade
[0m01:20:06.934992 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:06.935612 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m01:20:06.935928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92468040>]}
[0m01:20:06.936310 [info ] [Thread-1  ]: 4 of 9 OK created sql view model public.most_streamed_songs .................... [[32mCREATE VIEW[0m in 0.03s]
[0m01:20:06.936605 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m01:20:06.936825 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m01:20:06.937111 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m01:20:06.937338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m01:20:06.937516 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m01:20:06.939288 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.939853 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m01:20:06.942080 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.942547 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.942714 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m01:20:06.942861 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:06.944785 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:20:06.945002 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.945204 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    
    WITH all_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-10' as date)
    ),
    previous_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-10' as date)
    )
    SELECT
        a.artist_name
    FROM
        all_artists a
    LEFT JOIN
        previous_artists p ON a.artist_name = p.artist_name
    WHERE
        p.artist_name IS NULL

  );
[0m01:20:06.946912 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:20:06.948783 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.948967 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists" rename to "newly_discovered_artists__dbt_backup"
[0m01:20:06.949351 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.950761 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.950976 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists__dbt_tmp" rename to "newly_discovered_artists"
[0m01:20:06.951511 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.952179 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m01:20:06.952362 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.952535 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m01:20:06.952973 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:06.954221 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_artists__dbt_backup"
[0m01:20:06.955365 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m01:20:06.955581 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
drop view if exists "airflow"."public"."newly_discovered_artists__dbt_backup" cascade
[0m01:20:06.956486 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:06.957034 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m01:20:06.957347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920f3ee0>]}
[0m01:20:06.957707 [info ] [Thread-1  ]: 5 of 9 OK created sql view model public.newly_discovered_artists ............... [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:06.957988 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m01:20:06.958195 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:06.958457 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m01:20:06.958675 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m01:20:06.958843 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:06.960278 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.960824 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:06.962920 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.963317 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.963490 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: BEGIN
[0m01:20:06.963650 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:06.966401 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m01:20:06.966604 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.966793 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */

  create view "airflow"."public"."newly_discovered_tracks__dbt_tmp"
    
    
  as (
    
    WITH all_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-10' as date)
    ),
    previous_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-10' as date)
    )
    SELECT
        a.track_name
    FROM
        all_tracks a
    LEFT JOIN
        previous_tracks p ON a.track_name = p.track_name
    WHERE
        p.track_name IS NULL

  );
[0m01:20:06.968777 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:06.970603 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.970787 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks" rename to "newly_discovered_tracks__dbt_backup"
[0m01:20:06.971181 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.972645 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.972852 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks__dbt_tmp" rename to "newly_discovered_tracks"
[0m01:20:06.973305 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.973958 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m01:20:06.974129 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.974284 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m01:20:06.975223 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m01:20:06.976355 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_tracks__dbt_backup"
[0m01:20:06.976613 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m01:20:06.976795 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
drop view if exists "airflow"."public"."newly_discovered_tracks__dbt_backup" cascade
[0m01:20:06.977615 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:06.978150 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: Close
[0m01:20:06.978424 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9204f0a0>]}
[0m01:20:06.978743 [info ] [Thread-1  ]: 6 of 9 OK created sql view model public.newly_discovered_tracks ................ [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:06.979010 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m01:20:06.979208 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m01:20:06.979481 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m01:20:06.979695 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m01:20:06.979858 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m01:20:06.981460 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.981994 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m01:20:06.984786 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.985259 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.985429 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m01:20:06.985575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:06.987044 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m01:20:06.987210 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.987366 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    
    SELECT
        SUM(duration_ms / (60 * 1000)) AS total_minutes_streamed
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)

  );
[0m01:20:06.988525 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:20:06.990219 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.990388 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed" rename to "total_minutes_streamed__dbt_backup"
[0m01:20:06.990766 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.992081 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.992249 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed__dbt_tmp" rename to "total_minutes_streamed"
[0m01:20:06.992571 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:06.993139 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m01:20:06.993319 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.993567 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m01:20:06.993980 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:06.995140 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."total_minutes_streamed__dbt_backup"
[0m01:20:06.995444 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m01:20:06.995642 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
drop view if exists "airflow"."public"."total_minutes_streamed__dbt_backup" cascade
[0m01:20:06.996463 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:06.997065 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m01:20:06.997331 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920f3ee0>]}
[0m01:20:06.997661 [info ] [Thread-1  ]: 7 of 9 OK created sql view model public.total_minutes_streamed ................. [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:06.997943 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m01:20:06.998152 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m01:20:06.998415 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m01:20:06.998627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m01:20:06.998793 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m01:20:07.000251 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.000770 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_listened_to
[0m01:20:07.002820 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.003224 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.003400 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: BEGIN
[0m01:20:07.003553 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:07.005065 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m01:20:07.005248 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.005431 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */

  create view "airflow"."public"."tracks_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT track_name) AS total_tracks
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)

  );
[0m01:20:07.006745 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m01:20:07.008387 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.008554 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to" rename to "tracks_listened_to__dbt_backup"
[0m01:20:07.008884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:07.010242 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.010434 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to__dbt_tmp" rename to "tracks_listened_to"
[0m01:20:07.010748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:07.011278 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m01:20:07.011448 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.011603 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m01:20:07.012181 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:07.014972 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_listened_to__dbt_backup"
[0m01:20:07.015359 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m01:20:07.015610 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
drop view if exists "airflow"."public"."tracks_listened_to__dbt_backup" cascade
[0m01:20:07.016537 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:07.017197 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: Close
[0m01:20:07.017477 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9204e880>]}
[0m01:20:07.017805 [info ] [Thread-1  ]: 8 of 9 OK created sql view model public.tracks_listened_to ..................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:07.018078 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m01:20:07.018293 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m01:20:07.018550 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m01:20:07.018823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m01:20:07.019003 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m01:20:07.020807 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.021308 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_per_dow
[0m01:20:07.023572 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.023985 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.024142 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: BEGIN
[0m01:20:07.024283 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m01:20:07.026700 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m01:20:07.026887 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.027068 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */

  create view "airflow"."public"."tracks_per_dow__dbt_tmp"
    
    
  as (
    
    SELECT
        EXTRACT(DOW FROM played_at_ts) AS day_of_week,
        EXTRACT(HOUR FROM played_at_ts) AS hour,
        SUM(duration_ms / (1000 * 60)) AS total_minutes
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-10' as date) AND cast('2025-07-11' as date)
    GROUP BY
        1, 2

  );
[0m01:20:07.029358 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m01:20:07.031224 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.031415 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow" rename to "tracks_per_dow__dbt_backup"
[0m01:20:07.031783 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:07.033096 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.033284 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow__dbt_tmp" rename to "tracks_per_dow"
[0m01:20:07.033669 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m01:20:07.034342 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m01:20:07.034537 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.034751 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m01:20:07.035217 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m01:20:07.036415 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_per_dow__dbt_backup"
[0m01:20:07.036691 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m01:20:07.036868 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
drop view if exists "airflow"."public"."tracks_per_dow__dbt_backup" cascade
[0m01:20:07.037689 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m01:20:07.038249 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: Close
[0m01:20:07.038569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60cdc6b2-3ccf-40bf-bc86-a67dd623fcd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9204ee20>]}
[0m01:20:07.039064 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.tracks_per_dow ......................... [[32mCREATE VIEW[0m in 0.02s]
[0m01:20:07.039357 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m01:20:07.040402 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:07.040623 [debug] [MainThread]: On master: BEGIN
[0m01:20:07.040805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:07.042571 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m01:20:07.042744 [debug] [MainThread]: On master: COMMIT
[0m01:20:07.042890 [debug] [MainThread]: Using postgres connection "master"
[0m01:20:07.043020 [debug] [MainThread]: On master: COMMIT
[0m01:20:07.043197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m01:20:07.043339 [debug] [MainThread]: On master: Close
[0m01:20:07.043568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:07.043740 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m01:20:07.044044 [info ] [MainThread]: 
[0m01:20:07.044265 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 15.57 seconds (15.57s).
[0m01:20:07.045100 [debug] [MainThread]: Command end result
[0m01:20:07.068335 [info ] [MainThread]: 
[0m01:20:07.068661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:20:07.068857 [info ] [MainThread]: 
[0m01:20:07.069225 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m01:20:07.074317 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.465431, "process_user_time": 1.68763, "process_kernel_time": 0.38392, "process_mem_max_rss": "101500", "process_out_blocks": "2659", "process_in_blocks": "0"}
[0m01:20:07.074909 [debug] [MainThread]: Command `dbt run` succeeded at 01:20:07.074862 after 16.47 seconds
[0m01:20:07.075264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948751f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e347c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94cb68b0>]}
[0m01:20:07.075534 [debug] [MainThread]: Flushing usage events
[0m01:20:07.568774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:14:21.693997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04f8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb030ad60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7d3fd0>]}


============================== 04:14:21.695537 | 04bc8e0b-947d-4b85-a053-fc726231720e ==============================
[0m04:14:21.695537 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m04:14:21.695895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-11", "end_date": "2025-07-11" }', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:14:21.771786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea8b4c0>]}
[0m04:14:21.795204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7eb7c0>]}
[0m04:14:21.795566 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m04:14:21.802600 [debug] [MainThread]: checksum: 1ecf131d1077630ff92401dd5b498c0f4b9707c38ab1499fbba971eb6a6a3144, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-11'}, profile: , target: , version: 1.9.0b2
[0m04:14:21.838291 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m04:14:21.838609 [debug] [MainThread]: previous checksum: 1ecf131d1077630ff92401dd5b498c0f4b9707c38ab1499fbba971eb6a6a3144, current checksum: 15db23c23a855526e0d318fcc3125f85541d1a99e00a28fe27ede77919359a68
[0m04:14:21.838874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafce2a90>]}
[0m04:14:22.536593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea00c70>]}
[0m04:14:22.578838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea4d160>]}
[0m04:14:22.579142 [info ] [MainThread]: Found 9 models, 432 macros
[0m04:14:22.579408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae64e2e0>]}
[0m04:14:22.580335 [info ] [MainThread]: 
[0m04:14:22.580521 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:14:22.580661 [info ] [MainThread]: 
[0m04:14:22.580907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:14:22.583346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m04:14:22.599727 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m04:14:22.599970 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m04:14:22.600157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:14:22.603086 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m04:14:22.603976 [debug] [ThreadPool]: On list_airflow: Close
[0m04:14:22.605213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_public'
[0m04:14:22.608353 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m04:14:22.608542 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m04:14:22.608696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:15:43.356628 [debug] [ThreadPool]: SQL status: BEGIN in 5.042 seconds
[0m05:15:43.372361 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m05:15:43.376760 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m05:15:43.394552 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.015 seconds
[0m05:15:43.409264 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m05:15:43.409858 [debug] [ThreadPool]: On list_airflow_public: Close
[0m05:15:43.426195 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:43.426556 [debug] [MainThread]: On master: BEGIN
[0m05:15:43.426797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:15:48.436552 [debug] [MainThread]: SQL status: BEGIN in 5.009 seconds
[0m05:15:48.437528 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:48.438108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:15:48.448953 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m05:15:48.451937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae73a190>]}
[0m05:15:48.453016 [debug] [MainThread]: On master: ROLLBACK
[0m05:15:48.453737 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:48.454069 [debug] [MainThread]: On master: BEGIN
[0m05:15:48.454551 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m05:15:48.454852 [debug] [MainThread]: On master: COMMIT
[0m05:15:48.455132 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:48.455363 [debug] [MainThread]: On master: COMMIT
[0m05:15:48.455684 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:15:48.455996 [debug] [MainThread]: On master: Close
[0m05:15:48.460052 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m05:15:48.460596 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m05:15:48.461188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m05:15:48.461693 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m05:15:48.468710 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m05:15:48.470972 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m05:15:48.491035 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m05:15:48.491909 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m05:15:48.492126 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m05:15:48.492371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.502516 [debug] [Thread-1  ]: SQL status: BEGIN in 5.009 seconds
[0m05:15:53.503991 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m05:15:53.504403 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT artist_name) AS total_artists
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)

  );
[0m05:15:53.507575 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m05:15:53.516818 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m05:15:53.517180 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to" rename to "artists_listened_to__dbt_backup"
[0m05:15:53.517788 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.519751 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m05:15:53.520009 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to__dbt_tmp" rename to "artists_listened_to"
[0m05:15:53.520432 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.530084 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m05:15:53.530315 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m05:15:53.530519 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m05:15:53.531791 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m05:15:53.534896 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."artists_listened_to__dbt_backup"
[0m05:15:53.536880 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m05:15:53.537073 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
drop view if exists "airflow"."public"."artists_listened_to__dbt_backup" cascade
[0m05:15:53.538533 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.541654 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m05:15:53.542841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadeabe50>]}
[0m05:15:53.543255 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.artists_listened_to .................... [[32mCREATE VIEW[0m in 5.08s]
[0m05:15:53.543684 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m05:15:53.543928 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m05:15:53.544279 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m05:15:53.544552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m05:15:53.544768 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m05:15:53.546523 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.547116 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m05:15:53.549365 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.549791 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.549978 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m05:15:53.550148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.551772 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m05:15:53.551956 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.552126 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        SUM(duration_ms / (1000 * 60)) AS total_minutes_played
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        total_minutes_played DESC

  );
[0m05:15:53.553653 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.555378 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.555560 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist" rename to "minutes_per_artist__dbt_backup"
[0m05:15:53.555895 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.557249 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.557427 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist__dbt_tmp" rename to "minutes_per_artist"
[0m05:15:53.557743 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.558328 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m05:15:53.558497 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.558645 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m05:15:53.559383 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m05:15:53.560897 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."minutes_per_artist__dbt_backup"
[0m05:15:53.561264 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m05:15:53.561442 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
drop view if exists "airflow"."public"."minutes_per_artist__dbt_backup" cascade
[0m05:15:53.562283 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.562886 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m05:15:53.563159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae73a1f0>]}
[0m05:15:53.563502 [info ] [Thread-1  ]: 2 of 9 OK created sql view model public.minutes_per_artist ..................... [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.563811 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m05:15:53.564030 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m05:15:53.564300 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m05:15:53.564519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m05:15:53.564689 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m05:15:53.566890 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.567347 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m05:15:53.569381 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.569776 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.569956 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m05:15:53.570108 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.571499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m05:15:53.571690 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.571873 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        streams DESC

  );
[0m05:15:53.573310 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.574978 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.575146 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists" rename to "most_streamed_artists__dbt_backup"
[0m05:15:53.575455 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.576780 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.576951 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists__dbt_tmp" rename to "most_streamed_artists"
[0m05:15:53.577238 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.577763 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m05:15:53.577923 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.578061 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m05:15:53.578398 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m05:15:53.579531 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_artists__dbt_backup"
[0m05:15:53.579916 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m05:15:53.580174 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
drop view if exists "airflow"."public"."most_streamed_artists__dbt_backup" cascade
[0m05:15:53.581040 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.581592 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m05:15:53.581853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae6b9820>]}
[0m05:15:53.582155 [info ] [Thread-1  ]: 3 of 9 OK created sql view model public.most_streamed_artists .................. [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.582422 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m05:15:53.582629 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m05:15:53.582889 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m05:15:53.583109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m05:15:53.583283 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m05:15:53.584787 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.585266 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m05:15:53.587267 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.587917 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.588076 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m05:15:53.588223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.589574 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m05:15:53.589741 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.589916 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    
    SELECT
        track_name,
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        track_name,
        artist_name
    ORDER BY
        streams DESC

  );
[0m05:15:53.591243 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.593399 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.593561 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs" rename to "most_streamed_songs__dbt_backup"
[0m05:15:53.593857 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.595047 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.595214 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs__dbt_tmp" rename to "most_streamed_songs"
[0m05:15:53.595475 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.596054 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m05:15:53.596267 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.596527 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m05:15:53.597077 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m05:15:53.598230 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_songs__dbt_backup"
[0m05:15:53.598501 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m05:15:53.598672 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
drop view if exists "airflow"."public"."most_streamed_songs__dbt_backup" cascade
[0m05:15:53.599471 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.600033 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m05:15:53.600291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadeab040>]}
[0m05:15:53.600591 [info ] [Thread-1  ]: 4 of 9 OK created sql view model public.most_streamed_songs .................... [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.600854 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m05:15:53.601096 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m05:15:53.601383 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m05:15:53.601611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m05:15:53.601787 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m05:15:53.603286 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.603777 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m05:15:53.605875 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.606450 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.606635 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m05:15:53.606790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.608213 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m05:15:53.608384 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.608557 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    
    WITH all_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-11' as date)
    ),
    previous_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-11' as date)
    )
    SELECT
        a.artist_name
    FROM
        all_artists a
    LEFT JOIN
        previous_artists p ON a.artist_name = p.artist_name
    WHERE
        p.artist_name IS NULL

  );
[0m05:15:53.609898 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.611579 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.611761 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists" rename to "newly_discovered_artists__dbt_backup"
[0m05:15:53.612142 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.613460 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.613632 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists__dbt_tmp" rename to "newly_discovered_artists"
[0m05:15:53.613941 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.614464 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m05:15:53.614627 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.614768 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m05:15:53.615264 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m05:15:53.616465 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_artists__dbt_backup"
[0m05:15:53.618031 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m05:15:53.618266 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
drop view if exists "airflow"."public"."newly_discovered_artists__dbt_backup" cascade
[0m05:15:53.619205 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.619845 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m05:15:53.620157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadb17ee0>]}
[0m05:15:53.620534 [info ] [Thread-1  ]: 5 of 9 OK created sql view model public.newly_discovered_artists ............... [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.620945 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m05:15:53.621198 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m05:15:53.621530 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m05:15:53.621802 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m05:15:53.622036 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m05:15:53.623541 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.624036 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_tracks
[0m05:15:53.626126 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.626871 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.627038 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: BEGIN
[0m05:15:53.627195 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.628696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m05:15:53.628884 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.629059 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */

  create view "airflow"."public"."newly_discovered_tracks__dbt_tmp"
    
    
  as (
    
    WITH all_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-11' as date)
    ),
    previous_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-11' as date)
    )
    SELECT
        a.track_name
    FROM
        all_tracks a
    LEFT JOIN
        previous_tracks p ON a.track_name = p.track_name
    WHERE
        p.track_name IS NULL

  );
[0m05:15:53.630595 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.632277 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.632443 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks" rename to "newly_discovered_tracks__dbt_backup"
[0m05:15:53.632737 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.633952 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.634128 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks__dbt_tmp" rename to "newly_discovered_tracks"
[0m05:15:53.634446 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.634970 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m05:15:53.635134 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.635279 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m05:15:53.635928 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m05:15:53.637092 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_tracks__dbt_backup"
[0m05:15:53.637474 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m05:15:53.637733 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
drop view if exists "airflow"."public"."newly_discovered_tracks__dbt_backup" cascade
[0m05:15:53.638501 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.639043 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: Close
[0m05:15:53.639317 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada90520>]}
[0m05:15:53.639621 [info ] [Thread-1  ]: 6 of 9 OK created sql view model public.newly_discovered_tracks ................ [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.639892 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m05:15:53.640096 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m05:15:53.640338 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m05:15:53.640543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m05:15:53.640740 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m05:15:53.642273 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.642761 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m05:15:53.645532 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.645953 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.646121 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m05:15:53.646273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.648108 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m05:15:53.648304 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.648475 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    
    SELECT
        SUM(duration_ms / (60 * 1000)) AS total_minutes_streamed
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)

  );
[0m05:15:53.649967 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.651645 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.651888 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed" rename to "total_minutes_streamed__dbt_backup"
[0m05:15:53.652214 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.653648 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.654374 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed__dbt_tmp" rename to "total_minutes_streamed"
[0m05:15:53.654748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.655329 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m05:15:53.655513 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.655682 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m05:15:53.656246 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m05:15:53.657322 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."total_minutes_streamed__dbt_backup"
[0m05:15:53.657562 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m05:15:53.657718 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
drop view if exists "airflow"."public"."total_minutes_streamed__dbt_backup" cascade
[0m05:15:53.658472 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.659013 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m05:15:53.659273 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae3b3cd0>]}
[0m05:15:53.659613 [info ] [Thread-1  ]: 7 of 9 OK created sql view model public.total_minutes_streamed ................. [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.659885 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m05:15:53.660076 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m05:15:53.660329 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m05:15:53.660539 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m05:15:53.660704 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m05:15:53.662208 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.662689 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_listened_to
[0m05:15:53.664697 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.665073 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.665234 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: BEGIN
[0m05:15:53.665381 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.666831 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m05:15:53.667035 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.667212 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */

  create view "airflow"."public"."tracks_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT track_name) AS total_tracks
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)

  );
[0m05:15:53.668504 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.670404 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.670604 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to" rename to "tracks_listened_to__dbt_backup"
[0m05:15:53.671042 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.672602 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.672817 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to__dbt_tmp" rename to "tracks_listened_to"
[0m05:15:53.673168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.673906 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m05:15:53.674114 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.674285 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m05:15:53.674778 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m05:15:53.676813 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_listened_to__dbt_backup"
[0m05:15:53.677137 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m05:15:53.677332 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
drop view if exists "airflow"."public"."tracks_listened_to__dbt_backup" cascade
[0m05:15:53.678197 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.678801 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: Close
[0m05:15:53.679085 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadab9c70>]}
[0m05:15:53.679415 [info ] [Thread-1  ]: 8 of 9 OK created sql view model public.tracks_listened_to ..................... [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.679688 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m05:15:53.679909 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m05:15:53.680153 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m05:15:53.680362 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m05:15:53.680530 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m05:15:53.682026 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.682525 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_per_dow
[0m05:15:53.684642 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.685048 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.685210 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: BEGIN
[0m05:15:53.685358 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m05:15:53.686718 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m05:15:53.686900 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.687068 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */

  create view "airflow"."public"."tracks_per_dow__dbt_tmp"
    
    
  as (
    
    SELECT
        EXTRACT(DOW FROM played_at_ts) AS day_of_week,
        EXTRACT(HOUR FROM played_at_ts) AS hour,
        SUM(duration_ms / (1000 * 60)) AS total_minutes
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        1, 2

  );
[0m05:15:53.688297 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m05:15:53.689939 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.690102 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow" rename to "tracks_per_dow__dbt_backup"
[0m05:15:53.690405 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.691619 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.691777 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow__dbt_tmp" rename to "tracks_per_dow"
[0m05:15:53.692074 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m05:15:53.692598 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m05:15:53.692758 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.693003 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m05:15:53.693483 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m05:15:53.694712 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_per_dow__dbt_backup"
[0m05:15:53.694982 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m05:15:53.695151 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
drop view if exists "airflow"."public"."tracks_per_dow__dbt_backup" cascade
[0m05:15:53.695939 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m05:15:53.696497 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: Close
[0m05:15:53.696768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04bc8e0b-947d-4b85-a053-fc726231720e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadab9520>]}
[0m05:15:53.697084 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.tracks_per_dow ......................... [[32mCREATE VIEW[0m in 0.02s]
[0m05:15:53.697380 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m05:15:53.698292 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.698464 [debug] [MainThread]: On master: BEGIN
[0m05:15:53.698590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:15:53.700146 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m05:15:53.700299 [debug] [MainThread]: On master: COMMIT
[0m05:15:53.700436 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.700566 [debug] [MainThread]: On master: COMMIT
[0m05:15:53.700721 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m05:15:53.700867 [debug] [MainThread]: On master: Close
[0m05:15:53.701087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:15:53.701265 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m05:15:53.701414 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m05:15:53.701701 [info ] [MainThread]: 
[0m05:15:53.701901 [info ] [MainThread]: Finished running 9 view models in 1 hours 1 minutes and 31.12 seconds (3691.12s).
[0m05:15:53.702749 [debug] [MainThread]: Command end result
[0m05:15:53.723772 [info ] [MainThread]: 
[0m05:15:53.724091 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:15:53.724323 [info ] [MainThread]: 
[0m05:15:53.724576 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m05:15:53.727042 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.354675, "process_user_time": 1.588272, "process_kernel_time": 0.10924, "process_mem_max_rss": "101496", "process_out_blocks": "2658", "process_in_blocks": "0"}
[0m05:15:53.727939 [debug] [MainThread]: Command `dbt run` succeeded at 05:15:53.727892 after 16.36 seconds
[0m05:15:53.728410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb04f8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaea8b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae8a6910>]}
[0m05:15:53.728616 [debug] [MainThread]: Flushing usage events
[0m05:15:54.228849 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:17:56.827841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4e7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2ead60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7c2fd0>]}


============================== 07:17:56.829602 | 56a46a7b-b966-402e-af8a-2cbff489c332 ==============================
[0m07:17:56.829602 [info ] [MainThread]: Running with dbt=1.9.0-b2
[0m07:17:56.830106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --vars { "start_date": "2025-07-11", "end_date": "2025-07-11" }', 'send_anonymous_usage_stats': 'True'}
[0m07:17:56.907229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa654c0>]}
[0m07:17:56.930140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7da7c0>]}
[0m07:17:56.930496 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:17:56.937661 [debug] [MainThread]: checksum: 1ecf131d1077630ff92401dd5b498c0f4b9707c38ab1499fbba971eb6a6a3144, vars: {'end_date': '2025-07-11', 'start_date': '2025-07-11'}, profile: , target: , version: 1.9.0b2
[0m07:17:56.986246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:17:56.986479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:17:57.000125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa77ba30>]}
[0m07:17:57.040425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa7041f0>]}
[0m07:17:57.040674 [info ] [MainThread]: Found 9 models, 432 macros
[0m07:17:57.040894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa870220>]}
[0m07:17:57.041731 [info ] [MainThread]: 
[0m07:17:57.041911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:57.042052 [info ] [MainThread]: 
[0m07:17:57.042290 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:17:57.044497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:17:57.061588 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:17:57.061806 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:17:57.061989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:57.065218 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.003 seconds
[0m07:17:57.065736 [debug] [ThreadPool]: On list_airflow: Close
[0m07:17:57.066803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_public)
[0m07:17:57.069544 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m07:17:57.069710 [debug] [ThreadPool]: On list_airflow_public: BEGIN
[0m07:17:57.069897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:45:13.180889 [debug] [ThreadPool]: SQL status: BEGIN in 5.016 seconds
[0m07:45:13.182149 [debug] [ThreadPool]: Using postgres connection "list_airflow_public"
[0m07:45:13.182981 [debug] [ThreadPool]: On list_airflow_public: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "list_airflow_public"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:45:13.193085 [debug] [ThreadPool]: SQL status: SELECT 52 in 0.009 seconds
[0m07:45:13.206484 [debug] [ThreadPool]: On list_airflow_public: ROLLBACK
[0m07:45:13.219572 [debug] [ThreadPool]: On list_airflow_public: Close
[0m07:45:13.232121 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:13.239072 [debug] [MainThread]: On master: BEGIN
[0m07:45:13.239992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:13.251580 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m07:45:13.254950 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:13.255637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:45:13.265440 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m07:45:13.268279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa6b0f40>]}
[0m07:45:13.268715 [debug] [MainThread]: On master: ROLLBACK
[0m07:45:13.269064 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:13.269236 [debug] [MainThread]: On master: BEGIN
[0m07:45:13.269662 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:45:13.269836 [debug] [MainThread]: On master: COMMIT
[0m07:45:13.269980 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:13.270140 [debug] [MainThread]: On master: COMMIT
[0m07:45:13.270398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:13.270570 [debug] [MainThread]: On master: Close
[0m07:45:13.273575 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.artists_listened_to
[0m07:45:13.273999 [info ] [Thread-1  ]: 1 of 9 START sql view model public.artists_listened_to ......................... [RUN]
[0m07:45:13.275469 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_airflow_public, now model.spotify_wrapped.artists_listened_to)
[0m07:45:13.275956 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.artists_listened_to
[0m07:45:13.283363 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.artists_listened_to"
[0m07:45:13.288024 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.artists_listened_to
[0m07:45:13.323572 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.artists_listened_to"
[0m07:45:13.325022 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m07:45:13.325478 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: BEGIN
[0m07:45:13.326010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.343864 [debug] [Thread-1  ]: SQL status: BEGIN in 5.017 seconds
[0m07:45:18.346204 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m07:45:18.346548 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */

  create view "airflow"."public"."artists_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT artist_name) AS total_artists
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)

  );
[0m07:45:18.349521 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.003 seconds
[0m07:45:18.360790 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m07:45:18.361117 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to" rename to "artists_listened_to__dbt_backup"
[0m07:45:18.361838 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.363613 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m07:45:18.363837 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
alter table "airflow"."public"."artists_listened_to__dbt_tmp" rename to "artists_listened_to"
[0m07:45:18.364260 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.374122 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m07:45:18.374361 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m07:45:18.374589 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: COMMIT
[0m07:45:18.375618 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m07:45:18.378878 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."artists_listened_to__dbt_backup"
[0m07:45:18.380874 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.artists_listened_to"
[0m07:45:18.381098 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.artists_listened_to"} */
drop view if exists "airflow"."public"."artists_listened_to__dbt_backup" cascade
[0m07:45:18.382349 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.385068 [debug] [Thread-1  ]: On model.spotify_wrapped.artists_listened_to: Close
[0m07:45:18.389729 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9bafd90>]}
[0m07:45:18.390580 [info ] [Thread-1  ]: 1 of 9 OK created sql view model public.artists_listened_to .................... [[32mCREATE VIEW[0m in 5.11s]
[0m07:45:18.391229 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.artists_listened_to
[0m07:45:18.391686 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.minutes_per_artist
[0m07:45:18.392383 [info ] [Thread-1  ]: 2 of 9 START sql view model public.minutes_per_artist .......................... [RUN]
[0m07:45:18.392753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.artists_listened_to, now model.spotify_wrapped.minutes_per_artist)
[0m07:45:18.392968 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.minutes_per_artist
[0m07:45:18.395650 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.396871 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.minutes_per_artist
[0m07:45:18.399722 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.400340 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.400538 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: BEGIN
[0m07:45:18.400727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.403186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m07:45:18.403422 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.403618 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */

  create view "airflow"."public"."minutes_per_artist__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        SUM(duration_ms / (1000 * 60)) AS total_minutes_played
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        total_minutes_played DESC

  );
[0m07:45:18.405593 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:45:18.407562 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.407756 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist" rename to "minutes_per_artist__dbt_backup"
[0m07:45:18.408103 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.409567 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.409867 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
alter table "airflow"."public"."minutes_per_artist__dbt_tmp" rename to "minutes_per_artist"
[0m07:45:18.410446 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.411228 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m07:45:18.411456 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.411621 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: COMMIT
[0m07:45:18.412019 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.413290 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."minutes_per_artist__dbt_backup"
[0m07:45:18.413616 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.minutes_per_artist"
[0m07:45:18.413796 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.minutes_per_artist"} */
drop view if exists "airflow"."public"."minutes_per_artist__dbt_backup" cascade
[0m07:45:18.414609 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.415205 [debug] [Thread-1  ]: On model.spotify_wrapped.minutes_per_artist: Close
[0m07:45:18.415526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac341a00>]}
[0m07:45:18.415879 [info ] [Thread-1  ]: 2 of 9 OK created sql view model public.minutes_per_artist ..................... [[32mCREATE VIEW[0m in 0.02s]
[0m07:45:18.416189 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.minutes_per_artist
[0m07:45:18.416408 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_artists
[0m07:45:18.416664 [info ] [Thread-1  ]: 3 of 9 START sql view model public.most_streamed_artists ....................... [RUN]
[0m07:45:18.416896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.minutes_per_artist, now model.spotify_wrapped.most_streamed_artists)
[0m07:45:18.417065 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_artists
[0m07:45:18.419525 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.420003 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_artists
[0m07:45:18.422062 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.422467 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.422641 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: BEGIN
[0m07:45:18.422798 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.424397 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m07:45:18.424567 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.424746 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */

  create view "airflow"."public"."most_streamed_artists__dbt_tmp"
    
    
  as (
    
    SELECT
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        artist_name
    ORDER BY
        streams DESC

  );
[0m07:45:18.426321 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:18.428093 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.428335 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists" rename to "most_streamed_artists__dbt_backup"
[0m07:45:18.428677 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.429911 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.430076 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
alter table "airflow"."public"."most_streamed_artists__dbt_tmp" rename to "most_streamed_artists"
[0m07:45:18.430493 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.431081 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m07:45:18.431281 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.431522 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: COMMIT
[0m07:45:18.431985 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.433263 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_artists__dbt_backup"
[0m07:45:18.433515 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_artists"
[0m07:45:18.433690 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_artists"} */
drop view if exists "airflow"."public"."most_streamed_artists__dbt_backup" cascade
[0m07:45:18.434523 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.435071 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_artists: Close
[0m07:45:18.435396 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa2c3a0>]}
[0m07:45:18.435748 [info ] [Thread-1  ]: 3 of 9 OK created sql view model public.most_streamed_artists .................. [[32mCREATE VIEW[0m in 0.02s]
[0m07:45:18.436057 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_artists
[0m07:45:18.436270 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.most_streamed_songs
[0m07:45:18.436525 [info ] [Thread-1  ]: 4 of 9 START sql view model public.most_streamed_songs ......................... [RUN]
[0m07:45:18.436747 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_artists, now model.spotify_wrapped.most_streamed_songs)
[0m07:45:18.436923 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.most_streamed_songs
[0m07:45:18.438894 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.439375 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.most_streamed_songs
[0m07:45:18.441405 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.441982 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.442145 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: BEGIN
[0m07:45:18.442287 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.443751 [debug] [Thread-1  ]: SQL status: BEGIN in 0.001 seconds
[0m07:45:18.443944 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.444181 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */

  create view "airflow"."public"."most_streamed_songs__dbt_tmp"
    
    
  as (
    
    SELECT
        track_name,
        artist_name,
        COUNT(*) AS streams
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        track_name,
        artist_name
    ORDER BY
        streams DESC

  );
[0m07:45:18.445576 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:18.447963 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.448150 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs" rename to "most_streamed_songs__dbt_backup"
[0m07:45:18.448560 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.449954 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.450136 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
alter table "airflow"."public"."most_streamed_songs__dbt_tmp" rename to "most_streamed_songs"
[0m07:45:18.450481 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.451124 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m07:45:18.451308 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.451468 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: COMMIT
[0m07:45:18.452104 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.453446 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."most_streamed_songs__dbt_backup"
[0m07:45:18.453718 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.most_streamed_songs"
[0m07:45:18.453894 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.most_streamed_songs"} */
drop view if exists "airflow"."public"."most_streamed_songs__dbt_backup" cascade
[0m07:45:18.454740 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.455393 [debug] [Thread-1  ]: On model.spotify_wrapped.most_streamed_songs: Close
[0m07:45:18.455701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9b37f70>]}
[0m07:45:18.456042 [info ] [Thread-1  ]: 4 of 9 OK created sql view model public.most_streamed_songs .................... [[32mCREATE VIEW[0m in 0.02s]
[0m07:45:18.456416 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.most_streamed_songs
[0m07:45:18.456660 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_artists
[0m07:45:18.456924 [info ] [Thread-1  ]: 5 of 9 START sql view model public.newly_discovered_artists .................... [RUN]
[0m07:45:18.457181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.most_streamed_songs, now model.spotify_wrapped.newly_discovered_artists)
[0m07:45:18.457386 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_artists
[0m07:45:18.459373 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.459921 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_artists
[0m07:45:18.462182 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.462664 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.462835 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: BEGIN
[0m07:45:18.462993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.464685 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m07:45:18.464882 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.465052 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */

  create view "airflow"."public"."newly_discovered_artists__dbt_tmp"
    
    
  as (
    
    WITH all_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-11' as date)
    ),
    previous_artists AS (
        SELECT DISTINCT
            artist_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-11' as date)
    )
    SELECT
        a.artist_name
    FROM
        all_artists a
    LEFT JOIN
        previous_artists p ON a.artist_name = p.artist_name
    WHERE
        p.artist_name IS NULL

  );
[0m07:45:18.466471 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:18.468179 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.468357 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists" rename to "newly_discovered_artists__dbt_backup"
[0m07:45:18.468714 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.470023 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.470188 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
alter table "airflow"."public"."newly_discovered_artists__dbt_tmp" rename to "newly_discovered_artists"
[0m07:45:18.470578 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.471124 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m07:45:18.471288 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.471427 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: COMMIT
[0m07:45:18.472204 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m07:45:18.474326 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_artists__dbt_backup"
[0m07:45:18.474575 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_artists"
[0m07:45:18.474742 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_artists"} */
drop view if exists "airflow"."public"."newly_discovered_artists__dbt_backup" cascade
[0m07:45:18.475544 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.476081 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_artists: Close
[0m07:45:18.476362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa918dca0>]}
[0m07:45:18.476727 [info ] [Thread-1  ]: 5 of 9 OK created sql view model public.newly_discovered_artists ............... [[32mCREATE VIEW[0m in 0.02s]
[0m07:45:18.477028 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_artists
[0m07:45:18.477240 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.newly_discovered_tracks
[0m07:45:18.477496 [info ] [Thread-1  ]: 6 of 9 START sql view model public.newly_discovered_tracks ..................... [RUN]
[0m07:45:18.477730 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_artists, now model.spotify_wrapped.newly_discovered_tracks)
[0m07:45:18.477901 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.newly_discovered_tracks
[0m07:45:18.518434 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.519190 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.newly_discovered_tracks
[0m07:45:18.521293 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.521763 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.521934 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: BEGIN
[0m07:45:18.522083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.526141 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m07:45:18.526568 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.527006 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */

  create view "airflow"."public"."newly_discovered_tracks__dbt_tmp"
    
    
  as (
    
    WITH all_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts >= cast('2025-07-11' as date)
    ),
    previous_tracks AS (
        SELECT DISTINCT
            track_name
        FROM
            raw_spotify_songs
        WHERE
            played_at_ts < cast('2025-07-11' as date)
    )
    SELECT
        a.track_name
    FROM
        all_tracks a
    LEFT JOIN
        previous_tracks p ON a.track_name = p.track_name
    WHERE
        p.track_name IS NULL

  );
[0m07:45:18.529599 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.002 seconds
[0m07:45:18.531613 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.531811 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks" rename to "newly_discovered_tracks__dbt_backup"
[0m07:45:18.532401 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.533893 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.534088 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
alter table "airflow"."public"."newly_discovered_tracks__dbt_tmp" rename to "newly_discovered_tracks"
[0m07:45:18.534495 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.535116 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m07:45:18.535297 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.535473 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: COMMIT
[0m07:45:18.535916 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.537157 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."newly_discovered_tracks__dbt_backup"
[0m07:45:18.537424 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.newly_discovered_tracks"
[0m07:45:18.537586 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.newly_discovered_tracks"} */
drop view if exists "airflow"."public"."newly_discovered_tracks__dbt_backup" cascade
[0m07:45:18.538503 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.539093 [debug] [Thread-1  ]: On model.spotify_wrapped.newly_discovered_tracks: Close
[0m07:45:18.539401 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9186790>]}
[0m07:45:18.539738 [info ] [Thread-1  ]: 6 of 9 OK created sql view model public.newly_discovered_tracks ................ [[32mCREATE VIEW[0m in 0.06s]
[0m07:45:18.540081 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.newly_discovered_tracks
[0m07:45:18.540305 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.total_minutes_streamed
[0m07:45:18.540550 [info ] [Thread-1  ]: 7 of 9 START sql view model public.total_minutes_streamed ...................... [RUN]
[0m07:45:18.540771 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.newly_discovered_tracks, now model.spotify_wrapped.total_minutes_streamed)
[0m07:45:18.540943 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.total_minutes_streamed
[0m07:45:18.542883 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.543506 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.total_minutes_streamed
[0m07:45:18.545543 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.545945 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.546111 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: BEGIN
[0m07:45:18.546273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.548724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m07:45:18.548961 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.549173 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */

  create view "airflow"."public"."total_minutes_streamed__dbt_tmp"
    
    
  as (
    
    SELECT
        SUM(duration_ms / (60 * 1000)) AS total_minutes_streamed
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)

  );
[0m07:45:18.550772 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:18.553326 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.553499 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed" rename to "total_minutes_streamed__dbt_backup"
[0m07:45:18.553815 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.555105 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.555316 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
alter table "airflow"."public"."total_minutes_streamed__dbt_tmp" rename to "total_minutes_streamed"
[0m07:45:18.555670 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.556223 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m07:45:18.556402 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.556558 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: COMMIT
[0m07:45:18.557125 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.558238 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."total_minutes_streamed__dbt_backup"
[0m07:45:18.558493 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.total_minutes_streamed"
[0m07:45:18.558659 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.total_minutes_streamed"} */
drop view if exists "airflow"."public"."total_minutes_streamed__dbt_backup" cascade
[0m07:45:18.559450 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.560006 [debug] [Thread-1  ]: On model.spotify_wrapped.total_minutes_streamed: Close
[0m07:45:18.560293 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa67a550>]}
[0m07:45:18.560690 [info ] [Thread-1  ]: 7 of 9 OK created sql view model public.total_minutes_streamed ................. [[32mCREATE VIEW[0m in 0.02s]
[0m07:45:18.560991 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.total_minutes_streamed
[0m07:45:18.561263 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_listened_to
[0m07:45:18.561558 [info ] [Thread-1  ]: 8 of 9 START sql view model public.tracks_listened_to .......................... [RUN]
[0m07:45:18.561974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.total_minutes_streamed, now model.spotify_wrapped.tracks_listened_to)
[0m07:45:18.562384 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_listened_to
[0m07:45:18.565297 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.565971 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_listened_to
[0m07:45:18.569403 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.569904 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.570085 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: BEGIN
[0m07:45:18.570242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.571933 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m07:45:18.572119 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.572295 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */

  create view "airflow"."public"."tracks_listened_to__dbt_tmp"
    
    
  as (
    
    SELECT
        COUNT(DISTINCT track_name) AS total_tracks
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)

  );
[0m07:45:18.573580 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:18.575290 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.575474 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to" rename to "tracks_listened_to__dbt_backup"
[0m07:45:18.575835 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.577081 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.577241 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
alter table "airflow"."public"."tracks_listened_to__dbt_tmp" rename to "tracks_listened_to"
[0m07:45:18.577542 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.578093 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m07:45:18.578282 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.578523 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: COMMIT
[0m07:45:18.578920 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.580823 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_listened_to__dbt_backup"
[0m07:45:18.581086 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_listened_to"
[0m07:45:18.581273 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_listened_to"} */
drop view if exists "airflow"."public"."tracks_listened_to__dbt_backup" cascade
[0m07:45:18.582071 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.582615 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_listened_to: Close
[0m07:45:18.582899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9aabf40>]}
[0m07:45:18.583226 [info ] [Thread-1  ]: 8 of 9 OK created sql view model public.tracks_listened_to ..................... [[32mCREATE VIEW[0m in 0.02s]
[0m07:45:18.583523 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_listened_to
[0m07:45:18.583732 [debug] [Thread-1  ]: Began running node model.spotify_wrapped.tracks_per_dow
[0m07:45:18.584108 [info ] [Thread-1  ]: 9 of 9 START sql view model public.tracks_per_dow .............................. [RUN]
[0m07:45:18.584510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.spotify_wrapped.tracks_listened_to, now model.spotify_wrapped.tracks_per_dow)
[0m07:45:18.584684 [debug] [Thread-1  ]: Began compiling node model.spotify_wrapped.tracks_per_dow
[0m07:45:18.588076 [debug] [Thread-1  ]: Writing injected SQL for node "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.588695 [debug] [Thread-1  ]: Began executing node model.spotify_wrapped.tracks_per_dow
[0m07:45:18.590983 [debug] [Thread-1  ]: Writing runtime sql for node "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.591661 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.591831 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: BEGIN
[0m07:45:18.591983 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:45:18.593826 [debug] [Thread-1  ]: SQL status: BEGIN in 0.002 seconds
[0m07:45:18.594020 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.594192 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */

  create view "airflow"."public"."tracks_per_dow__dbt_tmp"
    
    
  as (
    
    SELECT
        EXTRACT(DOW FROM played_at_ts) AS day_of_week,
        EXTRACT(HOUR FROM played_at_ts) AS hour,
        SUM(duration_ms / (1000 * 60)) AS total_minutes
    FROM
        raw_spotify_songs
    WHERE
        played_at_ts BETWEEN cast('2025-07-11' as date) AND cast('2025-07-11' as date)
    GROUP BY
        1, 2

  );
[0m07:45:18.595858 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.001 seconds
[0m07:45:18.597788 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.597972 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow" rename to "tracks_per_dow__dbt_backup"
[0m07:45:18.598306 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.599624 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.599799 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
alter table "airflow"."public"."tracks_per_dow__dbt_tmp" rename to "tracks_per_dow"
[0m07:45:18.600084 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:45:18.600657 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m07:45:18.600848 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.601133 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: COMMIT
[0m07:45:18.601632 [debug] [Thread-1  ]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.602807 [debug] [Thread-1  ]: Applying DROP to: "airflow"."public"."tracks_per_dow__dbt_backup"
[0m07:45:18.603062 [debug] [Thread-1  ]: Using postgres connection "model.spotify_wrapped.tracks_per_dow"
[0m07:45:18.603223 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: /* {"app": "dbt", "dbt_version": "1.9.0b2", "profile_name": "spotify_wrapped", "target_name": "dev", "node_id": "model.spotify_wrapped.tracks_per_dow"} */
drop view if exists "airflow"."public"."tracks_per_dow__dbt_backup" cascade
[0m07:45:18.604016 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.001 seconds
[0m07:45:18.604573 [debug] [Thread-1  ]: On model.spotify_wrapped.tracks_per_dow: Close
[0m07:45:18.604853 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56a46a7b-b966-402e-af8a-2cbff489c332', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9aa1490>]}
[0m07:45:18.605206 [info ] [Thread-1  ]: 9 of 9 OK created sql view model public.tracks_per_dow ......................... [[32mCREATE VIEW[0m in 0.02s]
[0m07:45:18.605495 [debug] [Thread-1  ]: Finished running node model.spotify_wrapped.tracks_per_dow
[0m07:45:18.606196 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:18.606401 [debug] [MainThread]: On master: BEGIN
[0m07:45:18.606546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:45:18.607968 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m07:45:18.608129 [debug] [MainThread]: On master: COMMIT
[0m07:45:18.608272 [debug] [MainThread]: Using postgres connection "master"
[0m07:45:18.608403 [debug] [MainThread]: On master: COMMIT
[0m07:45:18.608574 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:45:18.608713 [debug] [MainThread]: On master: Close
[0m07:45:18.608909 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:45:18.609058 [debug] [MainThread]: Connection 'model.spotify_wrapped.tracks_per_dow' was properly closed.
[0m07:45:18.609305 [info ] [MainThread]: 
[0m07:45:18.609476 [info ] [MainThread]: Finished running 9 view models in 0 hours 27 minutes and 21.57 seconds (1641.57s).
[0m07:45:18.610189 [debug] [MainThread]: Command end result
[0m07:45:18.628752 [info ] [MainThread]: 
[0m07:45:18.629026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:45:18.629217 [info ] [MainThread]: 
[0m07:45:18.629451 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m07:45:18.630269 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.731353, "process_user_time": 0.956677, "process_kernel_time": 0.123116, "process_mem_max_rss": "97172", "process_out_blocks": "1818", "process_in_blocks": "0"}
[0m07:45:18.630591 [debug] [MainThread]: Command `dbt run` succeeded at 07:45:18.630543 after 10.73 seconds
[0m07:45:18.630813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac4e7190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2df310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaa3dc70>]}
[0m07:45:18.631006 [debug] [MainThread]: Flushing usage events
[0m07:45:19.152636 [debug] [MainThread]: An error was encountered while trying to flush usage events
